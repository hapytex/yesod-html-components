<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- | Sanatize HTML to prevent XSS attacks.</span><span>
</span><a name="line-3"></a><span class="hs-comment">--</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- See README.md &lt;http://github.com/gregwebs/haskell-xss-sanitize&gt; for more details.</span><span>
</span><a name="line-5"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.HTML.SanitizeXSS</span><span>
</span><a name="line-6"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-7"></a><span>    </span><span class="hs-comment">-- * Sanitize</span><span>
</span><a name="line-8"></a><span>      </span><a href="Text.HTML.SanitizeXSS.html#sanitize"><span class="hs-identifier hs-var">sanitize</span></a><span>
</span><a name="line-9"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitizeBalance"><span class="hs-identifier hs-var">sanitizeBalance</span></a><span>
</span><a name="line-10"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitizeXSS"><span class="hs-identifier hs-var">sanitizeXSS</span></a><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span>    </span><span class="hs-comment">-- * Custom filtering</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#filterTags"><span class="hs-identifier hs-var">filterTags</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTags"><span class="hs-identifier hs-var">safeTags</span></a><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balanceTags"><span class="hs-identifier hs-var">balanceTags</span></a><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagName"><span class="hs-identifier hs-var">safeTagName</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitizeAttribute"><span class="hs-identifier hs-var">sanitizeAttribute</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitaryURI"><span class="hs-identifier hs-var">sanitaryURI</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Text.HTML.SanitizeXSS.Css.html"><span class="hs-identifier">Text.HTML.SanitizeXSS.Css</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.HTML.TagSoup</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">member</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">notMember</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">\\</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromAscList</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Char</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network.URI</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">parseURIReference</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">URI</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>                     </span><span class="hs-identifier hs-var">isAllowedInURI</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">escapeURIString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uriScheme</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Codec.Binary.UTF8.String</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">encodeString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Sanitize HTML to prevent XSS attacks.  This is equivalent to @filterTags safeTags@.</span><span>
</span><a name="line-41"></a><span class="hs-identifier">sanitize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-42"></a><a name="sanitize"><a href="Text.HTML.SanitizeXSS.html#sanitize"><span class="hs-identifier">sanitize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitizeXSS"><span class="hs-identifier hs-var">sanitizeXSS</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | alias of sanitize function</span><span>
</span><a name="line-45"></a><span class="hs-identifier">sanitizeXSS</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-46"></a><a name="sanitizeXSS"><a href="Text.HTML.SanitizeXSS.html#sanitizeXSS"><span class="hs-identifier">sanitizeXSS</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#filterTags"><span class="hs-identifier hs-var">filterTags</span></a><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTags"><span class="hs-identifier hs-var">safeTags</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | Sanitize HTML to prevent XSS attacks and also make sure the tags are balanced.</span><span>
</span><a name="line-49"></a><span class="hs-comment">--   This is equivalent to @filterTags (balanceTags . safeTags)@.</span><span>
</span><a name="line-50"></a><span class="hs-identifier">sanitizeBalance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-51"></a><a name="sanitizeBalance"><a href="Text.HTML.SanitizeXSS.html#sanitizeBalance"><span class="hs-identifier">sanitizeBalance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#filterTags"><span class="hs-identifier hs-var">filterTags</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.SanitizeXSS.html#balanceTags"><span class="hs-identifier hs-var">balanceTags</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTags"><span class="hs-identifier hs-var">safeTags</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Filter which makes sure the tags are balanced.  Use with 'filterTags' and 'safeTags' to create a custom filter.</span><span>
</span><a name="line-54"></a><span class="hs-identifier">balanceTags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-55"></a><a name="balanceTags"><a href="Text.HTML.SanitizeXSS.html#balanceTags"><span class="hs-identifier">balanceTags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | Parse the given text to a list of tags, apply the given filtering</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- function, and render back to HTML. You can insert your own custom</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- filtering, but make sure you compose your filtering function with</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- 'safeTags' or 'safeTagsCustom'.</span><span>
</span><a name="line-61"></a><span class="hs-identifier">filterTags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-62"></a><a name="filterTags"><a href="Text.HTML.SanitizeXSS.html#filterTags"><span class="hs-identifier">filterTags</span></a></a><span> </span><a name="local-6989586621679044243"><a href="#local-6989586621679044243"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderTagsOptions</span><span> </span><span class="hs-identifier hs-var">renderOptions</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier">optMinimize</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679044294"><a href="#local-6989586621679044294"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679044294"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#voidElems"><span class="hs-identifier hs-var">voidElems</span></a><span> </span><span class="hs-comment">-- &lt;img&gt;&lt;img&gt; converts to &lt;img /&gt;, &lt;a/&gt; converts to &lt;a&gt;&lt;/a&gt;</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-operator hs-var">.</span><span>  </span><a href="#local-6989586621679044243"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">canonicalizeTags</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">parseTags</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-identifier">voidElems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">T.Text</span><span>
</span><a name="line-67"></a><a name="voidElems"><a href="Text.HTML.SanitizeXSS.html#voidElems"><span class="hs-identifier">voidElems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromAscList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.words</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;area base br col command embed hr img input keygen link meta param source track wbr&quot;</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-identifier">balance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ unclosed tags</span><span>
</span><a name="line-70"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-71"></a><a name="balance"><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier">balance</span></a></a><span> </span><a name="local-6989586621679044309"><a href="#local-6989586621679044309"><span class="hs-identifier">unclosed</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">TagClose</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">notMember</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#voidElems"><span class="hs-identifier hs-var">voidElems</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044309"><span class="hs-identifier hs-var">unclosed</span></a><span>
</span><a name="line-72"></a><span class="hs-identifier">balance</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679044310"><a href="#local-6989586621679044310"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679044311"><a href="#local-6989586621679044311"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679044312"><a href="#local-6989586621679044312"><span class="hs-identifier">tags'</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TagClose</span><span> </span><a name="local-6989586621679044313"><a href="#local-6989586621679044313"><span class="hs-identifier">name</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679044314"><a href="#local-6989586621679044314"><span class="hs-identifier">tags</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679044310"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TagClose</span><span> </span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><a href="#local-6989586621679044311"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679044314"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679044310"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#voidElems"><span class="hs-identifier hs-var">voidElems</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><a href="#local-6989586621679044311"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679044312"><span class="hs-identifier hs-var">tags'</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TagOpen</span><span> </span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">TagClose</span><span> </span><a href="#local-6989586621679044313"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044310"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679044311"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044314"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-76"></a><span class="hs-identifier">balance</span><span> </span><a name="local-6989586621679044315"><a href="#local-6989586621679044315"><span class="hs-identifier">unclosed</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TagOpen</span><span> </span><a name="local-6989586621679044316"><a href="#local-6989586621679044316"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679044318"><a href="#local-6989586621679044318"><span class="hs-identifier">tags</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-identifier hs-var">TagOpen</span><span> </span><a href="#local-6989586621679044316"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679044316"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679044315"><span class="hs-identifier hs-var">unclosed</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679044318"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-78"></a><span class="hs-identifier">balance</span><span> </span><a name="local-6989586621679044319"><a href="#local-6989586621679044319"><span class="hs-identifier">unclosed</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679044320"><a href="#local-6989586621679044320"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679044321"><a href="#local-6989586621679044321"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044320"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#balance"><span class="hs-identifier hs-var">balance</span></a><span> </span><a href="#local-6989586621679044319"><span class="hs-identifier hs-var">unclosed</span></a><span> </span><a href="#local-6989586621679044321"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- | Filters out unsafe tags and sanitizes attributes. Use with</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- filterTags to create a custom filter.</span><span>
</span><a name="line-82"></a><span class="hs-identifier">safeTags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-83"></a><a name="safeTags"><a href="Text.HTML.SanitizeXSS.html#safeTags"><span class="hs-identifier">safeTags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagName"><span class="hs-identifier hs-var">safeTagName</span></a><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitizeAttribute"><span class="hs-identifier hs-var">sanitizeAttribute</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | Filters out unsafe tags and sanitizes attributes, like</span><span>
</span><a name="line-86"></a><span class="hs-comment">-- 'safeTags', but uses custom functions for determining which tags</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- are safe and for sanitizing attributes. This allows you to add or</span><span>
</span><a name="line-88"></a><span class="hs-comment">-- remove specific tags or attributes on the white list, or to use</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- your own white list.</span><span>
</span><a name="line-90"></a><span class="hs-comment">--</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- @safeTagsCustom safeTagName sanitizeAttribute@ is equivalent to</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- 'safeTags'.</span><span>
</span><a name="line-93"></a><span class="hs-comment">--</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- @since 0.3.6</span><span>
</span><a name="line-95"></a><span class="hs-identifier">safeTagsCustom</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-96"></a><span>     </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ Select safe tags, like</span><span>
</span><a name="line-97"></a><span>                                          </span><span class="hs-comment">-- 'safeTagName'</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Sanitize attributes,</span><span>
</span><a name="line-99"></a><span>                                          </span><span class="hs-comment">-- like 'sanitizeAttribute'</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Tag</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-101"></a><a name="safeTagsCustom"><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier">safeTagsCustom</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-102"></a><span class="hs-identifier">safeTagsCustom</span><span> </span><a name="local-6989586621679044322"><a href="#local-6989586621679044322"><span class="hs-identifier">safeName</span></a></a><span> </span><a name="local-6989586621679044323"><a href="#local-6989586621679044323"><span class="hs-identifier">sanitizeAttr</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679044324"><a href="#local-6989586621679044324"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TagClose</span><span> </span><a name="local-6989586621679044325"><a href="#local-6989586621679044325"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679044326"><a href="#local-6989586621679044326"><span class="hs-identifier">tags</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044325"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044324"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">sanitizeAttr</span></a><span> </span><a href="#local-6989586621679044326"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="#local-6989586621679044322"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044323"><span class="hs-identifier hs-var">sanitizeAttr</span></a><span> </span><a href="#local-6989586621679044326"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-105"></a><span class="hs-identifier">safeTagsCustom</span><span> </span><a name="local-6989586621679044327"><a href="#local-6989586621679044327"><span class="hs-identifier">safeName</span></a></a><span> </span><a name="local-6989586621679044328"><a href="#local-6989586621679044328"><span class="hs-identifier">sanitizeAttr</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TagOpen</span><span> </span><a name="local-6989586621679044329"><a href="#local-6989586621679044329"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679044330"><a href="#local-6989586621679044330"><span class="hs-identifier">attributes</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679044331"><a href="#local-6989586621679044331"><span class="hs-identifier">tags</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679044327"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044329"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">TagOpen</span><span> </span><a href="#local-6989586621679044329"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span> </span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">sanitizeAttr</span></a><span> </span><a href="#local-6989586621679044330"><span class="hs-identifier hs-var">attributes</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-107"></a><span>      </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="#local-6989586621679044327"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">sanitizeAttr</span></a><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="#local-6989586621679044327"><span class="hs-identifier hs-var">safeName</span></a><span> </span><a href="#local-6989586621679044328"><span class="hs-identifier hs-var">sanitizeAttr</span></a><span> </span><a href="#local-6989586621679044331"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-109"></a><span class="hs-identifier">safeTagsCustom</span><span> </span><a name="local-6989586621679044332"><a href="#local-6989586621679044332"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679044333"><a href="#local-6989586621679044333"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679044334"><a href="#local-6989586621679044334"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679044335"><a href="#local-6989586621679044335"><span class="hs-identifier">tags</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044334"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeTagsCustom"><span class="hs-identifier hs-var">safeTagsCustom</span></a><span> </span><a href="#local-6989586621679044332"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679044333"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679044335"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-identifier">safeTagName</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-112"></a><a name="safeTagName"><a href="Text.HTML.SanitizeXSS.html#safeTagName"><span class="hs-identifier">safeTagName</span></a></a><span> </span><a name="local-6989586621679044336"><a href="#local-6989586621679044336"><span class="hs-identifier">tagname</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044336"><span class="hs-identifier hs-var">tagname</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitaryTags"><span class="hs-identifier hs-var">sanitaryTags</span></a><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-identifier">safeAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-115"></a><a name="safeAttribute"><a href="Text.HTML.SanitizeXSS.html#safeAttribute"><span class="hs-identifier">safeAttribute</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679044337"><a href="#local-6989586621679044337"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679044338"><a href="#local-6989586621679044338"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679044337"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitaryAttributes"><span class="hs-identifier hs-var">sanitaryAttributes</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679044337"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">notMember</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#uri_attributes"><span class="hs-identifier hs-var">uri_attributes</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="Text.HTML.SanitizeXSS.html#sanitaryURI"><span class="hs-identifier hs-var">sanitaryURI</span></a><span> </span><a href="#local-6989586621679044338"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | low-level API if you have your own HTML parser. Used by safeTags.</span><span>
</span><a name="line-119"></a><span class="hs-identifier">sanitizeAttribute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><a name="sanitizeAttribute"><a href="Text.HTML.SanitizeXSS.html#sanitizeAttribute"><span class="hs-identifier">sanitizeAttribute</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;style&quot;</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679044339"><a href="#local-6989586621679044339"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679044340"><a href="#local-6989586621679044340"><span class="hs-identifier">css</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.SanitizeXSS.Css.html#sanitizeCSS"><span class="hs-identifier hs-var">sanitizeCSS</span></a><span> </span><a href="#local-6989586621679044339"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">T.null</span><span> </span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">css</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;style&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679044340"><span class="hs-identifier hs-var">css</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-identifier">sanitizeAttribute</span><span> </span><a name="local-6989586621679044341"><a href="#local-6989586621679044341"><span class="hs-identifier">attr</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeAttribute"><span class="hs-identifier hs-var">safeAttribute</span></a><span> </span><a href="#local-6989586621679044341"><span class="hs-identifier hs-var">attr</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679044341"><span class="hs-identifier hs-var">attr</span></a><span>
</span><a name="line-124"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | Returns @True@ if the specified URI is not a potential security risk.</span><span>
</span><a name="line-128"></a><span class="hs-identifier">sanitaryURI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-129"></a><a name="sanitaryURI"><a href="Text.HTML.SanitizeXSS.html#sanitaryURI"><span class="hs-identifier">sanitaryURI</span></a></a><span> </span><a name="local-6989586621679044342"><a href="#local-6989586621679044342"><span class="hs-identifier">u</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">parseURIReference</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.SanitizeXSS.html#escapeURI"><span class="hs-identifier hs-var">escapeURI</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679044342"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-131"></a><span>     </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679044343"><a href="#local-6989586621679044343"><span class="hs-identifier">p</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">uriScheme</span><span> </span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span>
</span><a name="line-132"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">init</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">uriScheme</span><span> </span><a href="#local-6989586621679044343"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">member</span><span class="hs-special">`</span><span> </span><a href="Text.HTML.SanitizeXSS.html#safeURISchemes"><span class="hs-identifier hs-var">safeURISchemes</span></a><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>     </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Escape unicode characters in a URI.  Characters that are</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- already valid in a URI, including % and ?, are left alone.</span><span>
</span><a name="line-138"></a><span class="hs-identifier">escapeURI</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-139"></a><a name="escapeURI"><a href="Text.HTML.SanitizeXSS.html#escapeURI"><span class="hs-identifier">escapeURI</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">escapeURIString</span><span> </span><span class="hs-identifier hs-var">isAllowedInURI</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">encodeString</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-identifier">safeURISchemes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-142"></a><a name="safeURISchemes"><a href="Text.HTML.SanitizeXSS.html#safeURISchemes"><span class="hs-identifier">safeURISchemes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="Text.HTML.SanitizeXSS.html#acceptable_protocols"><span class="hs-identifier hs-var">acceptable_protocols</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-identifier">sanitaryTags</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-145"></a><a name="sanitaryTags"><a href="Text.HTML.SanitizeXSS.html#sanitaryTags"><span class="hs-identifier">sanitaryTags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.SanitizeXSS.html#acceptable_elements"><span class="hs-identifier hs-var">acceptable_elements</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Text.HTML.SanitizeXSS.html#mathml_elements"><span class="hs-identifier hs-var">mathml_elements</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Text.HTML.SanitizeXSS.html#svg_elements"><span class="hs-identifier hs-var">svg_elements</span></a><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-operator hs-var">\\</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="Text.HTML.SanitizeXSS.html#svg_allow_local_href"><span class="hs-identifier hs-var">svg_allow_local_href</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- extra filtering not implemented</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-identifier">sanitaryAttributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-149"></a><a name="sanitaryAttributes"><a href="Text.HTML.SanitizeXSS.html#sanitaryAttributes"><span class="hs-identifier">sanitaryAttributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.SanitizeXSS.html#allowed_html_uri_attributes"><span class="hs-identifier hs-var">allowed_html_uri_attributes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Text.HTML.SanitizeXSS.html#acceptable_attributes"><span class="hs-identifier hs-var">acceptable_attributes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Text.HTML.SanitizeXSS.html#mathml_attributes"><span class="hs-identifier hs-var">mathml_attributes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Text.HTML.SanitizeXSS.html#svg_attributes"><span class="hs-identifier hs-var">svg_attributes</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-operator hs-var">\\</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="Text.HTML.SanitizeXSS.html#svg_attr_val_allows_ref"><span class="hs-identifier hs-var">svg_attr_val_allows_ref</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- extra unescaping not implemented</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-identifier">allowed_html_uri_attributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-153"></a><a name="allowed_html_uri_attributes"><a href="Text.HTML.SanitizeXSS.html#allowed_html_uri_attributes"><span class="hs-identifier">allowed_html_uri_attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;href&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;src&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cite&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;action&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;longdesc&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-identifier">uri_attributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-156"></a><a name="uri_attributes"><a href="Text.HTML.SanitizeXSS.html#uri_attributes"><span class="hs-identifier">uri_attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.HTML.SanitizeXSS.html#allowed_html_uri_attributes"><span class="hs-identifier hs-var">allowed_html_uri_attributes</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;xlink:href&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xml:base&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-identifier">acceptable_elements</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-159"></a><a name="acceptable_elements"><a href="Text.HTML.SanitizeXSS.html#acceptable_elements"><span class="hs-identifier">acceptable_elements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;a&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;abbr&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;acronym&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;address&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;area&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-160"></a><span>    </span><span class="hs-string">&quot;article&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;aside&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;audio&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;b&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;big&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;blockquote&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;br&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;button&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-161"></a><span>    </span><span class="hs-string">&quot;canvas&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;caption&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;center&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cite&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;code&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;col&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;colgroup&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-string">&quot;command&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datagrid&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datalist&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dd&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;del&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;details&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dfn&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-string">&quot;dialog&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dir&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;div&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dl&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dt&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;em&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;event-source&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fieldset&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-string">&quot;figcaption&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;figure&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;footer&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;form&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;header&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;h1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;h2&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-string">&quot;h3&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;h4&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;h5&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;h6&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hr&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;i&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;img&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;input&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ins&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;keygen&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-string">&quot;kbd&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;label&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;legend&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;li&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;m&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;main&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;map&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;menu&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;meter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;multicol&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-string">&quot;nav&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;nextid&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ol&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;output&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;optgroup&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;option&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;p&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;pre&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-string">&quot;progress&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;q&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;s&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;samp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;section&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;select&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;small&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;sound&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-string">&quot;source&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;spacer&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;span&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;strike&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;strong&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;sub&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;sup&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;table&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-string">&quot;tbody&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;td&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;textarea&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;time&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tfoot&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;th&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;thead&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tr&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tt&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-string">&quot;u&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ul&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;var&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;video&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-identifier">mathml_elements</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-174"></a><a name="mathml_elements"><a href="Text.HTML.SanitizeXSS.html#mathml_elements"><span class="hs-identifier">mathml_elements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;maction&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;math&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;merror&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mfrac&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mi&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-string">&quot;mmultiscripts&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mn&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mo&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mover&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mpadded&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mphantom&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-string">&quot;mprescripts&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mroot&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mrow&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mspace&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;msqrt&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mstyle&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;msub&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-string">&quot;msubsup&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;msup&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mtable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mtd&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mtext&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mtr&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;munder&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-string">&quot;munderover&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;none&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">-- this should include altGlyph I think</span><span>
</span><a name="line-181"></a><span class="hs-identifier">svg_elements</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-182"></a><a name="svg_elements"><a href="Text.HTML.SanitizeXSS.html#svg_elements"><span class="hs-identifier">svg_elements</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;a&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animate&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animateColor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animateMotion&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-string">&quot;animateTransform&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;clipPath&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;circle&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;defs&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;desc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ellipse&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-string">&quot;font-face&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-face-name&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-face-src&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;g&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;glyph&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hkern&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-string">&quot;linearGradient&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;line&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;metadata&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;missing-glyph&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-string">&quot;mpath&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;path&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;polygon&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;polyline&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;radialGradient&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rect&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-187"></a><span>    </span><span class="hs-string">&quot;set&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stop&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;svg&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;switch&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;text&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;title&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tspan&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;use&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-identifier">acceptable_attributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-190"></a><a name="acceptable_attributes"><a href="Text.HTML.SanitizeXSS.html#acceptable_attributes"><span class="hs-identifier">acceptable_attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;abbr&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;accept&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;accept-charset&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;accesskey&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-string">&quot;align&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;alt&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;autocomplete&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;autofocus&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;axis&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-string">&quot;background&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;balance&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bgcolor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bgproperties&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;border&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-193"></a><span>    </span><span class="hs-string">&quot;bordercolor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bordercolordark&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bordercolorlight&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bottompadding&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-194"></a><span>    </span><span class="hs-string">&quot;cellpadding&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cellspacing&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ch&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;challenge&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;char&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;charoff&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-195"></a><span>    </span><span class="hs-string">&quot;choff&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;charset&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;checked&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;class&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;clear&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;color&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-string">&quot;cols&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;colspan&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;compact&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;contenteditable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;controls&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;coords&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-197"></a><span>    </span><span class="hs-comment">-- &quot;data&quot;, TODO: allow this with further filtering</span><span>
</span><a name="line-198"></a><span>    </span><span class="hs-string">&quot;datafld&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datapagesize&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datasrc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;datetime&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;default&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-199"></a><span>    </span><span class="hs-string">&quot;delay&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dir&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;disabled&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;draggable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dynsrc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;enctype&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;end&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-200"></a><span>    </span><span class="hs-string">&quot;face&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;for&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;form&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;frame&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;galleryimg&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;gutter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;headers&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-string">&quot;height&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hidefocus&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hidden&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;high&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hreflang&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hspace&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-string">&quot;icon&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;id&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;inputmode&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ismap&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;keytype&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;label&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;leftspacing&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-string">&quot;lang&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;list&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;loop&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;loopcount&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;loopend&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-204"></a><span>    </span><span class="hs-string">&quot;loopstart&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;low&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;lowsrc&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;max&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;maxlength&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;media&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;method&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-205"></a><span>    </span><span class="hs-string">&quot;min&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;multiple&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;name&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;nohref&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;noshade&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;nowrap&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;open&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-206"></a><span>    </span><span class="hs-string">&quot;optimum&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;pattern&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ping&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;point-size&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;prompt&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;pqg&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-207"></a><span>    </span><span class="hs-string">&quot;radiogroup&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;readonly&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rel&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;repeat-max&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;repeat-min&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-string">&quot;replace&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;required&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rev&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rightspacing&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rows&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowspan&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-string">&quot;rules&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;scope&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;selected&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;shape&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;size&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;span&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;start&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-string">&quot;step&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-211"></a><span>    </span><span class="hs-string">&quot;style&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- gets further filtering</span><span>
</span><a name="line-212"></a><span>    </span><span class="hs-string">&quot;summary&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;suppress&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tabindex&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;target&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-string">&quot;template&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;title&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;toppadding&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;unselectable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;usemap&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-214"></a><span>    </span><span class="hs-string">&quot;urn&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;valign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;value&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;variable&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;volume&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;vspace&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;vrml&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-string">&quot;width&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;wrap&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xml:lang&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-identifier">acceptable_protocols</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-218"></a><a name="acceptable_protocols"><a href="Text.HTML.SanitizeXSS.html#acceptable_protocols"><span class="hs-identifier">acceptable_protocols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;ed2k&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ftp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;http&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;https&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;irc&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-219"></a><span>    </span><span class="hs-string">&quot;mailto&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;news&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;gopher&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;nntp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;telnet&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;webcal&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-220"></a><span>    </span><span class="hs-string">&quot;xmpp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;callto&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;feed&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;urn&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;aim&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rsync&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tag&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-string">&quot;ssh&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;sftp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rtsp&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;afs&quot;</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-identifier">mathml_attributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-224"></a><a name="mathml_attributes"><a href="Text.HTML.SanitizeXSS.html#mathml_attributes"><span class="hs-identifier">mathml_attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;actiontype&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;align&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;columnalign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;columnalign&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-225"></a><span>    </span><span class="hs-string">&quot;columnalign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;columnlines&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;columnspacing&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;columnspan&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;depth&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-226"></a><span>    </span><span class="hs-string">&quot;display&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;displaystyle&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;equalcolumns&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;equalrows&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fence&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-string">&quot;fontstyle&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fontweight&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;frame&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;height&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;linethickness&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;lspace&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-string">&quot;mathbackground&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mathcolor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mathvariant&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mathvariant&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;maxsize&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-string">&quot;minsize&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;other&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowalign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowalign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowalign&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowlines&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-string">&quot;rowspacing&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rowspan&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rspace&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;scriptlevel&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;selection&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-string">&quot;separator&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stretchy&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;width&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;width&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:href&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:show&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-232"></a><span>    </span><span class="hs-string">&quot;xlink:type&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xmlns&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xmlns:xlink&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">svg_attributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-235"></a><a name="svg_attributes"><a href="Text.HTML.SanitizeXSS.html#svg_attributes"><span class="hs-identifier">svg_attributes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;accent-height&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;accumulate&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;additive&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;alphabetic&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-236"></a><span>    </span><span class="hs-string">&quot;arabic-form&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ascent&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;attributeName&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;attributeType&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-237"></a><span>    </span><span class="hs-string">&quot;baseProfile&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;bbox&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;begin&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;by&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;calcMode&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cap-height&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-string">&quot;class&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;clip-path&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;color&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;color-rendering&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;content&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cx&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-string">&quot;cy&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;d&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dx&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dy&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;descent&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;display&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;dur&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;end&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fill&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-240"></a><span>    </span><span class="hs-string">&quot;fill-opacity&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fill-rule&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-family&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-size&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-string">&quot;font-stretch&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-style&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-variant&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;font-weight&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;from&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-string">&quot;fx&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fy&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;g1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;g2&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;glyph-name&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;gradientUnits&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;hanging&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-string">&quot;height&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;horiz-adv-x&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;horiz-origin-x&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;id&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ideographic&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;k&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-244"></a><span>    </span><span class="hs-string">&quot;keyPoints&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;keySplines&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;keyTimes&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;lang&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker-end&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-245"></a><span>    </span><span class="hs-string">&quot;marker-mid&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker-start&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;markerHeight&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;markerUnits&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-string">&quot;markerWidth&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;mathematical&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;max&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;min&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;name&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;offset&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-string">&quot;opacity&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;orient&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;origin&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;overline-position&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-248"></a><span>    </span><span class="hs-string">&quot;overline-thickness&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;panose-1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;path&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;pathLength&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;points&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-string">&quot;preserveAspectRatio&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;r&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;refX&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;refY&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;repeatCount&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-string">&quot;repeatDur&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;requiredExtensions&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;requiredFeatures&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;restart&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-string">&quot;rotate&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;rx&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;ry&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;slope&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stemh&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stemv&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stop-color&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-252"></a><span>    </span><span class="hs-string">&quot;stop-opacity&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;strikethrough-position&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;strikethrough-thickness&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-253"></a><span>    </span><span class="hs-string">&quot;stroke&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke-dasharray&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke-dashoffset&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke-linecap&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-254"></a><span>    </span><span class="hs-string">&quot;stroke-linejoin&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke-miterlimit&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke-opacity&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-255"></a><span>    </span><span class="hs-string">&quot;stroke-width&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;systemLanguage&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;target&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;text-anchor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;to&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-string">&quot;transform&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;type&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;u2&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;underline-position&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-257"></a><span>    </span><span class="hs-string">&quot;underline-thickness&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;unicode&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;unicode-range&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;units-per-em&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-258"></a><span>    </span><span class="hs-string">&quot;values&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;version&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;viewBox&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;visibility&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;width&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;widths&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;x&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-259"></a><span>    </span><span class="hs-string">&quot;x-height&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;x1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;x2&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:actuate&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:arcrole&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-string">&quot;xlink:href&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:role&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:show&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:title&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xlink:type&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-string">&quot;xml:base&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xml:lang&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xml:space&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xmlns&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;xmlns:xlink&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;y&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-string">&quot;y1&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;y2&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;zoomAndPan&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- the values for these need to be escaped</span><span>
</span><a name="line-265"></a><span class="hs-identifier">svg_attr_val_allows_ref</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-266"></a><a name="svg_attr_val_allows_ref"><a href="Text.HTML.SanitizeXSS.html#svg_attr_val_allows_ref"><span class="hs-identifier">svg_attr_val_allows_ref</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;clip-path&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;color-profile&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cursor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;fill&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-267"></a><span>    </span><span class="hs-string">&quot;filter&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker-start&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker-mid&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;marker-end&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-string">&quot;mask&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;stroke&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-identifier">svg_allow_local_href</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-271"></a><a name="svg_allow_local_href"><a href="Text.HTML.SanitizeXSS.html#svg_allow_local_href"><span class="hs-identifier">svg_allow_local_href</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;altGlyph&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animate&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animateColor&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-string">&quot;animateMotion&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;animateTransform&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;cursor&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;feImage&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;filter&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-273"></a><span>    </span><span class="hs-string">&quot;linearGradient&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;pattern&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;radialGradient&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;textpath&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;tref&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-string">&quot;set&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;use&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a></pre></body></html>