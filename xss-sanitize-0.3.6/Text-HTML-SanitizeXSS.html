<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Text.HTML.SanitizeXSS</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Text.HTML.SanitizeXSS.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">xss-sanitize-0.3.6: sanitize untrusted HTML to prevent XSS attacks</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Text.HTML.SanitizeXSS</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Sanitize</a></li><li><a href="#g:2">Custom filtering</a></li><li><a href="#g:3">Utilities</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Sanatize HTML to prevent XSS attacks.</p><p>See README.md <a href="http://github.com/gregwebs/haskell-xss-sanitize">http://github.com/gregwebs/haskell-xss-sanitize</a> for more details.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:sanitize">sanitize</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:sanitizeBalance">sanitizeBalance</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:sanitizeXSS">sanitizeXSS</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:filterTags">filterTags</a> :: ([<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]) -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li class="src short"><a href="#v:safeTags">safeTags</a> :: [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]</li><li class="src short"><a href="#v:safeTagsCustom">safeTagsCustom</a> :: (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; ((<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>)) -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]</li><li class="src short"><a href="#v:balanceTags">balanceTags</a> :: [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]</li><li class="src short"><a href="#v:safeTagName">safeTagName</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:sanitizeAttribute">sanitizeAttribute</a> :: (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><a href="#v:sanitaryURI">sanitaryURI</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Sanitize</h1></a><div class="top"><p class="src"><a id="v:sanitize" class="def">sanitize</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Text.HTML.SanitizeXSS.html#sanitize" class="link">Source</a> <a href="#v:sanitize" class="selflink">#</a></p><div class="doc"><p>Sanitize HTML to prevent XSS attacks.  This is equivalent to <code>filterTags safeTags</code>.</p></div></div><div class="top"><p class="src"><a id="v:sanitizeBalance" class="def">sanitizeBalance</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Text.HTML.SanitizeXSS.html#sanitizeBalance" class="link">Source</a> <a href="#v:sanitizeBalance" class="selflink">#</a></p><div class="doc"><p>Sanitize HTML to prevent XSS attacks and also make sure the tags are balanced.
   This is equivalent to <code>filterTags (balanceTags . safeTags)</code>.</p></div></div><div class="top"><p class="src"><a id="v:sanitizeXSS" class="def">sanitizeXSS</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Text.HTML.SanitizeXSS.html#sanitizeXSS" class="link">Source</a> <a href="#v:sanitizeXSS" class="selflink">#</a></p><div class="doc"><p>alias of sanitize function</p></div></div><a href="#g:2" id="g:2"><h1>Custom filtering</h1></a><div class="top"><p class="src"><a id="v:filterTags" class="def">filterTags</a> :: ([<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]) -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="src/Text.HTML.SanitizeXSS.html#filterTags" class="link">Source</a> <a href="#v:filterTags" class="selflink">#</a></p><div class="doc"><p>Parse the given text to a list of tags, apply the given filtering
 function, and render back to HTML. You can insert your own custom
 filtering, but make sure you compose your filtering function with
 <code><a href="Text-HTML-SanitizeXSS.html#v:safeTags" title="Text.HTML.SanitizeXSS">safeTags</a></code> or <code><a href="Text-HTML-SanitizeXSS.html#v:safeTagsCustom" title="Text.HTML.SanitizeXSS">safeTagsCustom</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:safeTags" class="def">safeTags</a> :: [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] <a href="src/Text.HTML.SanitizeXSS.html#safeTags" class="link">Source</a> <a href="#v:safeTags" class="selflink">#</a></p><div class="doc"><p>Filters out unsafe tags and sanitizes attributes. Use with
 filterTags to create a custom filter.</p></div></div><div class="top"><p class="src"><a id="v:safeTagsCustom" class="def">safeTagsCustom</a> <a href="src/Text.HTML.SanitizeXSS.html#safeTagsCustom" class="link">Source</a> <a href="#v:safeTagsCustom" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>)</td><td class="doc"><p>Select safe tags, like
 <code><a href="Text-HTML-SanitizeXSS.html#v:safeTagName" title="Text.HTML.SanitizeXSS">safeTagName</a></code></p></td></tr><tr><td class="src">-&gt; ((<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>))</td><td class="doc"><p>Sanitize attributes,
 like <code><a href="Text-HTML-SanitizeXSS.html#v:sanitizeAttribute" title="Text.HTML.SanitizeXSS">sanitizeAttribute</a></code></p></td></tr><tr><td class="src">-&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Filters out unsafe tags and sanitizes attributes, like
 <code><a href="Text-HTML-SanitizeXSS.html#v:safeTags" title="Text.HTML.SanitizeXSS">safeTags</a></code>, but uses custom functions for determining which tags
 are safe and for sanitizing attributes. This allows you to add or
 remove specific tags or attributes on the white list, or to use
 your own white list.</p><p><code>safeTagsCustom safeTagName sanitizeAttribute</code> is equivalent to
 <code><a href="Text-HTML-SanitizeXSS.html#v:safeTags" title="Text.HTML.SanitizeXSS">safeTags</a></code>.</p><p><em>Since: 0.3.6</em></p></div></div><div class="top"><p class="src"><a id="v:balanceTags" class="def">balanceTags</a> :: [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; [<a href="../tagsoup-0.14.8/Text-HTML-TagSoup.html#t:Tag" title="Text.HTML.TagSoup">Tag</a> <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>] <a href="src/Text.HTML.SanitizeXSS.html#balanceTags" class="link">Source</a> <a href="#v:balanceTags" class="selflink">#</a></p><div class="doc"><p>Filter which makes sure the tags are balanced.  Use with <code><a href="Text-HTML-SanitizeXSS.html#v:filterTags" title="Text.HTML.SanitizeXSS">filterTags</a></code> and <code><a href="Text-HTML-SanitizeXSS.html#v:safeTags" title="Text.HTML.SanitizeXSS">safeTags</a></code> to create a custom filter.</p></div></div><a href="#g:3" id="g:3"><h1>Utilities</h1></a><div class="top"><p class="src"><a id="v:safeTagName" class="def">safeTagName</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Text.HTML.SanitizeXSS.html#safeTagName" class="link">Source</a> <a href="#v:safeTagName" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:sanitizeAttribute" class="def">sanitizeAttribute</a> :: (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>) -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> (<a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>, <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a>) <a href="src/Text.HTML.SanitizeXSS.html#sanitizeAttribute" class="link">Source</a> <a href="#v:sanitizeAttribute" class="selflink">#</a></p><div class="doc"><p>low-level API if you have your own HTML parser. Used by safeTags.</p></div></div><div class="top"><p class="src"><a id="v:sanitaryURI" class="def">sanitaryURI</a> :: <a href="../text-1.2.3.1/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Text.HTML.SanitizeXSS.html#sanitaryURI" class="link">Source</a> <a href="#v:sanitaryURI" class="selflink">#</a></p><div class="doc"><p>Returns <code>True</code> if the specified URI is not a potential security risk.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>