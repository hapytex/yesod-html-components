<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- | Field functions allow you to easily create and validate forms, cleanly handling the uncertainty of parsing user input.</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- When possible, the field functions use a specific input type (e.g. &quot;number&quot;), allowing supporting browsers to validate the input before form submission. Browsers can also improve usability with this information; for example, mobile browsers might present a specialized keyboard for an input of type &quot;email&quot; or &quot;number&quot;.</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- See the Yesod book &lt;http://www.yesodweb.com/book/forms chapter on forms&gt; for a broader overview of forms in Yesod.</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Yesod.Form.Fields</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * i18n</span><span>
</span><a name="line-15"></a><span>      </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#defaultFormMessage"><span class="hs-identifier hs-var">defaultFormMessage</span></a><span>
</span><a name="line-17"></a><span>      </span><span class="hs-comment">-- * Fields</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#textField"><span class="hs-identifier hs-var">textField</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#passwordField"><span class="hs-identifier hs-var">passwordField</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#textareaField"><span class="hs-identifier hs-var">textareaField</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#hiddenField"><span class="hs-identifier hs-var">hiddenField</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#intField"><span class="hs-identifier hs-var">intField</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#dayField"><span class="hs-identifier hs-var">dayField</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#timeField"><span class="hs-identifier hs-var">timeField</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#timeFieldTypeTime"><span class="hs-identifier hs-var">timeFieldTypeTime</span></a><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#timeFieldTypeText"><span class="hs-identifier hs-var">timeFieldTypeText</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#htmlField"><span class="hs-identifier hs-var">htmlField</span></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#emailField"><span class="hs-identifier hs-var">emailField</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#multiEmailField"><span class="hs-identifier hs-var">multiEmailField</span></a><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#searchField"><span class="hs-identifier hs-var">searchField</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier hs-type">AutoFocus</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#urlField"><span class="hs-identifier hs-var">urlField</span></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#doubleField"><span class="hs-identifier hs-var">doubleField</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#parseTime"><span class="hs-identifier hs-var">parseTime</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#boolField"><span class="hs-identifier hs-var">boolField</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#checkBoxField"><span class="hs-identifier hs-var">checkBoxField</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#fileField"><span class="hs-identifier hs-var">fileField</span></a><span>
</span><a name="line-40"></a><span>      </span><span class="hs-comment">-- * File 'AForm's</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#fileAFormReq"><span class="hs-identifier hs-var">fileAFormReq</span></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#fileAFormOpt"><span class="hs-identifier hs-var">fileAFormOpt</span></a><span>
</span><a name="line-43"></a><span>      </span><span class="hs-comment">-- * Options</span><span>
</span><a name="line-44"></a><span>      </span><span class="hs-comment">-- $optionsOverview</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#selectFieldHelper"><span class="hs-identifier hs-var">selectFieldHelper</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#selectField"><span class="hs-identifier hs-var">selectField</span></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#selectFieldList"><span class="hs-identifier hs-var">selectFieldList</span></a><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#radioField"><span class="hs-identifier hs-var">radioField</span></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#radioFieldList"><span class="hs-identifier hs-var">radioFieldList</span></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#checkboxesField"><span class="hs-identifier hs-var">checkboxesField</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#checkboxesFieldList"><span class="hs-identifier hs-var">checkboxesFieldList</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#multiSelectField"><span class="hs-identifier hs-var">multiSelectField</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#multiSelectFieldList"><span class="hs-identifier hs-var">multiSelectFieldList</span></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-type">Option</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier hs-var">mkOptionList</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#optionsPersist"><span class="hs-identifier hs-var">optionsPersist</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#optionsPersistKey"><span class="hs-identifier hs-var">optionsPersistKey</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Fields.html#optionsEnum"><span class="hs-identifier hs-var">optionsEnum</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><a href="Yesod.Form.Types.html"><span class="hs-identifier">Yesod.Form.Types</span></a><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><a href="Yesod.Form.I18n.English.html"><span class="hs-identifier">Yesod.Form.I18n.English</span></a><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><a href="Yesod.Form.Functions.html"><span class="hs-identifier">Yesod.Form.Functions</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod.Core</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Blaze</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToMarkup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toMarkup</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unsafeByteString</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span class="hs-cpp">#define ToHtml ToMarkup
#define toHtml toMarkup
#define preEscapedText preEscapedToMarkup
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Time</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Day</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Text.Email.Validate</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Email</span><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text.Encoding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">encodeUtf8</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text.Encoding.Error</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lenientDecode</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network.URI</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">parseURI</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.Persist.Sql</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PersistField</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistFieldSql</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-cpp">#if MIN_VERSION_persistent(2,5,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Entity</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SqlType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">SqlString</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistRecordBackend</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistQueryRead</span><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Database.Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Entity</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">SqlType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SqlString</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistEntity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistQuery</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistEntityBackend</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.HTML.SanitizeXSS</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sanitizeBalance</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">when</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unless</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">partitionEithers</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Blaze.ByteString.Builder.Html.Utf8</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">B</span><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Blaze.ByteString.Builder</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">writeByteString</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toLazyByteString</span><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Blaze.ByteString.Builder.Internal.Write</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromWriteList</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Blaze.Html.Renderer.String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">renderHtml</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString.Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">L</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">append</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">cons</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">head</span><span>
</span><a name="line-95"></a><span>                      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">unpack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pack</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitOn</span><span>
</span><a name="line-96"></a><span>                      </span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text.Read</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod.Persist</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">selectList</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Filter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">SelectOpt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Key</span><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Attoparsec.Text</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Parser</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">char</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">string</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">digit</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">skipSpace</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">endOfInput</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod.Persist.Core</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IsString</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-cpp">#if !MIN_VERSION_base(4,8,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span>
</span><a name="line-114"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-116"></a><span class="hs-identifier">defaultFormMessage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-117"></a><a name="defaultFormMessage"><a href="Yesod.Form.Fields.html#defaultFormMessage"><span class="hs-identifier">defaultFormMessage</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.I18n.English.html#englishFormMessage"><span class="hs-identifier hs-var">englishFormMessage</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | Creates a input with @type=&quot;number&quot;@ and @step=1@.</span><span>
</span><a name="line-120"></a><span class="hs-identifier">intField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193853"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679193854"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193853"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193853"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679193854"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-121"></a><a name="intField"><a href="Yesod.Form.Fields.html#intField"><span class="hs-identifier">intField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193858"><a href="#local-6989586621679193858"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-123"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Data.Text.Read.signed</span><span> </span><span class="hs-identifier hs-var">Data.Text.Read.decimal</span><span> </span><a href="#local-6989586621679193858"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-124"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193859"><a href="#local-6989586621679193859"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679193859"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-125"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidInteger"><span class="hs-identifier hs-var">MsgInvalidInteger</span></a><span> </span><a href="#local-6989586621679193858"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193860"><a href="#local-6989586621679193860"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193861"><a href="#local-6989586621679193861"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193862"><a href="#local-6989586621679193862"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193863"><a href="#local-6989586621679193863"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193864"><a href="#local-6989586621679193864"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;number&quot; step=1 :isReq:required=&quot;&quot; value=&quot;#{showVal val}&quot;&gt;
|]</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-133"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>    </span><a name="local-6989586621679193855"><a href="#local-6989586621679193855"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679193856"><span class="hs-identifier hs-var">showI</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>    </span><a name="local-6989586621679193856"><a href="#local-6989586621679193856"><span class="hs-identifier">showI</span></a></a><span> </span><a name="local-6989586621679193857"><a href="#local-6989586621679193857"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679193857"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-comment">-- | Creates a input with @type=&quot;number&quot;@ and @step=any@.</span><span>
</span><a name="line-138"></a><span class="hs-identifier">doubleField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193852"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193852"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193852"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-139"></a><a name="doubleField"><a href="Yesod.Form.Fields.html#doubleField"><span class="hs-identifier">doubleField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193871"><a href="#local-6989586621679193871"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-141"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Data.Text.Read.double</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#prependZero"><span class="hs-identifier hs-var">prependZero</span></a><span> </span><a href="#local-6989586621679193871"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-142"></a><span>            </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679193872"><a href="#local-6989586621679193872"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679193872"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-143"></a><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidNumber"><span class="hs-identifier hs-var">MsgInvalidNumber</span></a><span> </span><a href="#local-6989586621679193871"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193873"><a href="#local-6989586621679193873"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193874"><a href="#local-6989586621679193874"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193875"><a href="#local-6989586621679193875"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193876"><a href="#local-6989586621679193876"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193877"><a href="#local-6989586621679193877"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;number&quot; step=any :isReq:required=&quot;&quot; value=&quot;#{showVal val}&quot;&gt;
|]</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679193870"><a href="#local-6989586621679193870"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Creates an input with @type=&quot;date&quot;@, validating the input using the 'parseDate' function.</span><span>
</span><a name="line-154"></a><span class="hs-comment">--</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.Calendar&quot; module to use this function.</span><span>
</span><a name="line-156"></a><span class="hs-identifier">dayField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193851"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193851"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193851"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Day</span><span>
</span><a name="line-157"></a><a name="dayField"><a href="Yesod.Form.Fields.html#dayField"><span class="hs-identifier">dayField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Fields.html#parseDate"><span class="hs-identifier hs-var">parseDate</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unpack</span><span>
</span><a name="line-159"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193884"><a href="#local-6989586621679193884"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193885"><a href="#local-6989586621679193885"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193886"><a href="#local-6989586621679193886"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193887"><a href="#local-6989586621679193887"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193888"><a href="#local-6989586621679193888"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;date&quot; :isReq:required=&quot;&quot; value=&quot;#{showVal val}&quot;&gt;
|]</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-164"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679193883"><a href="#local-6989586621679193883"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | An alias for 'timeFieldTypeTime'.</span><span>
</span><a name="line-168"></a><span class="hs-identifier">timeField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193850"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193850"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193850"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-169"></a><a name="timeField"><a href="Yesod.Form.Fields.html#timeField"><span class="hs-identifier">timeField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#timeFieldTypeTime"><span class="hs-identifier hs-var">timeFieldTypeTime</span></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-comment">-- | Creates an input with @type=&quot;time&quot;@. &lt;http://caniuse.com/#search=time%20input%20type Browsers not supporting this type&gt; will fallback to a text field, and Yesod will parse the time as described in 'timeFieldTypeText'.</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- </span><span>
</span><a name="line-173"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.LocalTime&quot; module to use this function.</span><span>
</span><a name="line-174"></a><span class="hs-comment">--</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- Since 1.4.2</span><span>
</span><a name="line-176"></a><span class="hs-identifier">timeFieldTypeTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193849"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193849"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193849"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-177"></a><a name="timeFieldTypeTime"><a href="Yesod.Form.Fields.html#timeFieldTypeTime"><span class="hs-identifier">timeFieldTypeTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier hs-var">timeFieldOfType</span></a><span> </span><span class="hs-string">&quot;time&quot;</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | Creates an input with @type=&quot;text&quot;@, parsing the time from an [H]H:MM[:SS] format, with an optional AM or PM (if not given, AM is assumed for compatibility with the 24 hour clock system).</span><span>
</span><a name="line-180"></a><span class="hs-comment">--</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- This function exists for backwards compatibility with the old implementation of 'timeField', which used to use @type=&quot;text&quot;@. Consider using 'timeField' or 'timeFieldTypeTime' for improved UX and validation from the browser.</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- </span><span>
</span><a name="line-183"></a><span class="hs-comment">-- Add the @time@ package and import the &quot;Data.Time.LocalTime&quot; module to use this function.</span><span>
</span><a name="line-184"></a><span class="hs-comment">--</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- Since 1.4.2</span><span>
</span><a name="line-186"></a><span class="hs-identifier">timeFieldTypeText</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193848"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193848"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193848"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-187"></a><a name="timeFieldTypeText"><a href="Yesod.Form.Fields.html#timeFieldTypeText"><span class="hs-identifier">timeFieldTypeText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier hs-var">timeFieldOfType</span></a><span> </span><span class="hs-string">&quot;text&quot;</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-identifier">timeFieldOfType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193847"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193847"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193847"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-190"></a><a name="timeFieldOfType"><a href="Yesod.Form.Fields.html#timeFieldOfType"><span class="hs-identifier">timeFieldOfType</span></a></a><span> </span><a name="local-6989586621679193894"><a href="#local-6989586621679193894"><span class="hs-identifier">inputType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><a href="Yesod.Form.Fields.html#parseTime"><span class="hs-identifier hs-var">parseTime</span></a><span>
</span><a name="line-192"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193899"><a href="#local-6989586621679193899"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193900"><a href="#local-6989586621679193900"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193901"><a href="#local-6989586621679193901"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193902"><a href="#local-6989586621679193902"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193903"><a href="#local-6989586621679193903"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;#{inputType}&quot; :isReq:required=&quot;&quot; value=&quot;#{showVal val}&quot;&gt;
|]</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-197"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-198"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-199"></a><span>    </span><a name="local-6989586621679193895"><a href="#local-6989586621679193895"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679193896"><span class="hs-identifier hs-var">roundFullSeconds</span></a><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>    </span><a name="local-6989586621679193896"><a href="#local-6989586621679193896"><span class="hs-identifier">roundFullSeconds</span></a></a><span> </span><a name="local-6989586621679193897"><a href="#local-6989586621679193897"><span class="hs-identifier">tod</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-201"></a><span>        </span><span class="hs-identifier hs-var">TimeOfDay</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">todHour</span><span> </span><a href="#local-6989586621679193897"><span class="hs-identifier hs-var">tod</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">todMin</span><span> </span><a href="#local-6989586621679193897"><span class="hs-identifier hs-var">tod</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193898"><span class="hs-identifier hs-var">fullSec</span></a><span>
</span><a name="line-202"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-203"></a><span>        </span><a name="local-6989586621679193898"><a href="#local-6989586621679193898"><span class="hs-identifier">fullSec</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">floor</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">todSec</span><span> </span><a href="#local-6989586621679193897"><span class="hs-identifier hs-var">tod</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">-- | Creates a @\&lt;textarea&gt;@ tag whose input is sanitized to prevent XSS attacks and is validated for having balanced tags.</span><span>
</span><a name="line-206"></a><span class="hs-identifier">htmlField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193846"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193846"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193846"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Html</span><span>
</span><a name="line-207"></a><a name="htmlField"><a href="Yesod.Form.Fields.html#htmlField"><span class="hs-identifier">htmlField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-208"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">preEscapedText</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">sanitizeBalance</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193910"><a href="#local-6989586621679193910"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193911"><a href="#local-6989586621679193911"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193912"><a href="#local-6989586621679193912"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193913"><a href="#local-6989586621679193913"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193914"><a href="#local-6989586621679193914"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;textarea :isReq:required=&quot;&quot; id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs}&gt;#{showVal val}
|]</span><span>
</span><a name="line-213"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-214"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679193909"><a href="#local-6989586621679193909"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">renderHtml</span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- | A newtype wrapper around a 'Text' whose 'ToMarkup' instance converts newlines to HTML @\&lt;br&gt;@ tags.</span><span>
</span><a name="line-218"></a><span class="hs-comment">-- </span><span>
</span><a name="line-219"></a><span class="hs-comment">-- (When text is entered into a @\&lt;textarea&gt;@, newline characters are used to separate lines.</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- If this text is then placed verbatim into HTML, the lines won't be separated, thus the need for replacing with @\&lt;br&gt;@ tags).</span><span>
</span><a name="line-221"></a><span class="hs-comment">-- If you don't need this functionality, simply use 'unTextarea' to access the raw text.</span><span>
</span><a name="line-222"></a><span class="hs-keyword">newtype</span><span> </span><a name="Textarea"><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier">Textarea</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Textarea"><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier">Textarea</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unTextarea"><a href="Yesod.Form.Fields.html#unTextarea"><span class="hs-identifier">unTextarea</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-223"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistField</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">FromJSON</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IsString</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">PersistFieldSql</span><span> </span><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-225"></a><span>    </span><a name="local-8214565720323804655"><span class="hs-identifier">sqlType</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">SqlString</span><span>
</span><a name="line-226"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToHtml</span><span> </span><span class="hs-identifier">Textarea</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-8214565720323793798"><span class="hs-identifier">toHtml</span></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-228"></a><span>        </span><span class="hs-identifier hs-var">unsafeByteString</span><span>
</span><a name="line-229"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">S.concat</span><span>
</span><a name="line-230"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">L.toChunks</span><span>
</span><a name="line-231"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toLazyByteString</span><span>
</span><a name="line-232"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromWriteList</span><span> </span><a href="#local-6989586621679191115"><span class="hs-identifier hs-var">writeHtmlEscapedChar</span></a><span>
</span><a name="line-233"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">unpack</span><span>
</span><a name="line-234"></a><span>        </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unTextarea</span><span>
</span><a name="line-235"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-236"></a><span>        </span><span class="hs-comment">-- Taken from blaze-builder and modified with newline handling.</span><span>
</span><a name="line-237"></a><span>        </span><a name="local-6989586621679191115"><a href="#local-6989586621679191115"><span class="hs-identifier">writeHtmlEscapedChar</span></a></a><span> </span><span class="hs-char">'\r'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-238"></a><span>        </span><span class="hs-identifier">writeHtmlEscapedChar</span><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">writeByteString</span><span> </span><span class="hs-string">&quot;&lt;br&gt;&quot;</span><span>
</span><a name="line-239"></a><span>        </span><span class="hs-identifier">writeHtmlEscapedChar</span><span> </span><a name="local-6989586621679191136"><a href="#local-6989586621679191136"><span class="hs-identifier">c</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">B.writeHtmlEscapedChar</span><span> </span><a href="#local-6989586621679191136"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | Creates a @\&lt;textarea&gt;@ tag whose returned value is wrapped in a 'Textarea'; see 'Textarea' for details.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">textareaField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193845"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193845"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193845"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-type">Textarea</span></a><span>
</span><a name="line-243"></a><a name="textareaField"><a href="Yesod.Form.Fields.html#textareaField"><span class="hs-identifier">textareaField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-244"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#Textarea"><span class="hs-identifier hs-var">Textarea</span></a><span>
</span><a name="line-245"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193920"><a href="#local-6989586621679193920"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193921"><a href="#local-6989586621679193921"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193922"><a href="#local-6989586621679193922"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193923"><a href="#local-6989586621679193923"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193924"><a href="#local-6989586621679193924"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;textarea id=&quot;#{theId}&quot; name=&quot;#{name}&quot; :isReq:required=&quot;&quot; *{attrs}&gt;#{either id unTextarea val}
|]</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-250"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-comment">-- | Creates an input with @type=&quot;hidden&quot;@; you can use this to store information in a form that users shouldn't see (for example, Yesod stores CSRF tokens in a hidden field).</span><span>
</span><a name="line-253"></a><span class="hs-identifier">hiddenField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193843"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PathPiece</span><span> </span><a href="#local-6989586621679193844"><span class="hs-identifier hs-type">p</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193843"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193843"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679193844"><span class="hs-identifier hs-type">p</span></a><span>
</span><a name="line-255"></a><a name="hiddenField"><a href="Yesod.Form.Fields.html#hiddenField"><span class="hs-identifier">hiddenField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-256"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="Yesod.Form.Types.html#MsgValueRequired"><span class="hs-identifier hs-var">MsgValueRequired</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromPathPiece</span><span>
</span><a name="line-257"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193930"><a href="#local-6989586621679193930"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193931"><a href="#local-6989586621679193931"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193932"><a href="#local-6989586621679193932"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193933"><a href="#local-6989586621679193933"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193934"><a href="#local-6989586621679193934"><span class="hs-identifier">_isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input type=&quot;hidden&quot; id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} value=&quot;#{either id toPathPiece val}&quot;&gt;
|]</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-262"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- | Creates a input with @type=&quot;text&quot;@.</span><span>
</span><a name="line-265"></a><span class="hs-identifier">textField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193842"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193842"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193842"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-266"></a><a name="textField"><a href="Yesod.Form.Fields.html#textField"><span class="hs-identifier">textField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-267"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193940"><a href="#local-6989586621679193940"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193941"><a href="#local-6989586621679193941"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193942"><a href="#local-6989586621679193942"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679193943"><a href="#local-6989586621679193943"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679193944"><a href="#local-6989586621679193944"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-269"></a><span>        </span><span class="">[whamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;text&quot; :isReq:required value=&quot;#{either id id val}&quot;&gt;
|]</span><span>
</span><a name="line-273"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-274"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- | Creates an input with @type=&quot;password&quot;@.</span><span>
</span><a name="line-276"></a><span class="hs-identifier">passwordField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193841"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193841"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193841"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-277"></a><a name="passwordField"><a href="Yesod.Form.Fields.html#passwordField"><span class="hs-identifier">passwordField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-278"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-279"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679193949"><a href="#local-6989586621679193949"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679193950"><a href="#local-6989586621679193950"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679193951"><a href="#local-6989586621679193951"><span class="hs-identifier">attrs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679193952"><a href="#local-6989586621679193952"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;password&quot; :isReq:required=&quot;&quot;&gt;
|]</span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-284"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-285"></a><span>
</span><a name="line-286"></a><span class="hs-identifier">readMay</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679193840"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679193840"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-287"></a><a name="readMay"><a href="Yesod.Form.Fields.html#readMay"><span class="hs-identifier">readMay</span></a></a><span> </span><a name="local-6989586621679193958"><a href="#local-6989586621679193958"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Prelude.null</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">reads</span><span> </span><a href="#local-6989586621679193958"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-288"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679193989"><a href="#local-6989586621679193989"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679193989"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-289"></a><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-comment">-- | Parses a 'Day' from a 'String'.</span><span>
</span><a name="line-292"></a><span class="hs-identifier">parseDate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-identifier hs-type">Day</span><span>
</span><a name="line-293"></a><a name="parseDate"><a href="Yesod.Form.Fields.html#parseDate"><span class="hs-identifier">parseDate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidDay"><span class="hs-identifier hs-var">MsgInvalidDay</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-294"></a><span>              </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#readMay"><span class="hs-identifier hs-var">readMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#replace"><span class="hs-identifier hs-var">replace</span></a><span> </span><span class="hs-char">'/'</span><span> </span><span class="hs-char">'-'</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- | Replaces all instances of a value in a list by another value.</span><span>
</span><a name="line-297"></a><span class="hs-comment">-- from http://hackage.haskell.org/packages/archive/cgi/3001.1.7.1/doc/html/src/Network-CGI-Protocol.html#replace</span><span>
</span><a name="line-298"></a><span class="hs-identifier">replace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193839"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679193839"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193839"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193839"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193839"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-299"></a><a name="replace"><a href="Yesod.Form.Fields.html#replace"><span class="hs-identifier">replace</span></a></a><span> </span><a name="local-6989586621679193990"><a href="#local-6989586621679193990"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679193991"><a href="#local-6989586621679193991"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679193992"><a href="#local-6989586621679193992"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679193992"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679193990"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679193991"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679193992"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-identifier">parseTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-302"></a><a name="parseTime"><a href="Yesod.Form.Fields.html#parseTime"><span class="hs-identifier">parseTime</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidTimeFormat"><span class="hs-identifier hs-var">MsgInvalidTimeFormat</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#readMay"><span class="hs-identifier hs-var">readMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-char">':'</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">parseOnly</span><span> </span><a href="Yesod.Form.Fields.html#timeParser"><span class="hs-identifier hs-var">timeParser</span></a><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-identifier">timeParser</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><span class="hs-identifier hs-type">TimeOfDay</span><span>
</span><a name="line-305"></a><a name="timeParser"><a href="Yesod.Form.Fields.html#timeParser"><span class="hs-identifier">timeParser</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a name="line-307"></a><span>    </span><a name="local-6989586621679194005"><a href="#local-6989586621679194005"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679193993"><span class="hs-identifier hs-var">hour</span></a><span>
</span><a name="line-308"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">':'</span><span>
</span><a name="line-309"></a><span>    </span><a name="local-6989586621679194006"><a href="#local-6989586621679194006"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679193994"><span class="hs-identifier hs-var">minsec</span></a><span> </span><a href="Yesod.Form.Types.html#MsgInvalidMinute"><span class="hs-identifier hs-var">MsgInvalidMinute</span></a><span>
</span><a name="line-310"></a><span>    </span><a name="local-6989586621679194007"><a href="#local-6989586621679194007"><span class="hs-identifier">hasSec</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">char</span><span> </span><span class="hs-char">':'</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-311"></a><span>    </span><a name="local-6989586621679194008"><a href="#local-6989586621679194008"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194007"><span class="hs-identifier hs-var">hasSec</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679193994"><span class="hs-identifier hs-var">minsec</span></a><span> </span><a href="Yesod.Form.Types.html#MsgInvalidSecond"><span class="hs-identifier hs-var">MsgInvalidSecond</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-312"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a name="line-313"></a><span>    </span><a name="local-6989586621679194009"><a href="#local-6989586621679194009"><span class="hs-identifier">isPM</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-314"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;am&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a name="line-315"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;AM&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a name="line-316"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;pm&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a name="line-317"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">string</span><span> </span><span class="hs-string">&quot;PM&quot;</span><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span>
</span><a name="line-318"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-319"></a><span>    </span><a name="local-6989586621679194011"><a href="#local-6989586621679194011"><span class="hs-identifier">h'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><a name="line-320"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194009"><span class="hs-identifier hs-var">isPM</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-321"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-322"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194010"><a href="#local-6989586621679194010"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-323"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidHour"><span class="hs-identifier hs-var">MsgInvalidHour</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span>
</span><a name="line-324"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194010"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-325"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194005"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194010"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">12</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span>    </span><span class="hs-identifier hs-var">skipSpace</span><span>
</span><a name="line-327"></a><span>    </span><span class="hs-identifier hs-var">endOfInput</span><span>
</span><a name="line-328"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TimeOfDay</span><span> </span><a href="#local-6989586621679194011"><span class="hs-identifier hs-var">h'</span></a><span> </span><a href="#local-6989586621679194006"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679194008"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-329"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-330"></a><span>    </span><a name="local-6989586621679193993"><a href="#local-6989586621679193993"><span class="hs-identifier">hour</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-331"></a><span>        </span><a name="local-6989586621679193996"><a href="#local-6989586621679193996"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span>
</span><a name="line-332"></a><span>        </span><a name="local-6989586621679193997"><a href="#local-6989586621679193997"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">Control.Applicative.&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">digit</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-333"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679193998"><a href="#local-6989586621679193998"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679193996"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679193997"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-334"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679193999"><a href="#local-6989586621679193999"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679193998"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-335"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679193999"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679193999"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">24</span><span>
</span><a name="line-336"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidHour"><span class="hs-identifier hs-var">MsgInvalidHour</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="#local-6989586621679193998"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-337"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679193999"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-338"></a><span>    </span><span class="hs-identifier">minsec</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679193995"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Parser</span><span> </span><a href="#local-6989586621679193995"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-339"></a><span>    </span><a name="local-6989586621679193994"><a href="#local-6989586621679193994"><span class="hs-identifier">minsec</span></a></a><span> </span><a name="local-6989586621679194000"><a href="#local-6989586621679194000"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-340"></a><span>        </span><a name="local-6989586621679194001"><a href="#local-6989586621679194001"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span>
</span><a name="line-341"></a><span>        </span><a name="local-6989586621679194002"><a href="#local-6989586621679194002"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">digit</span><span> </span><span class="hs-operator hs-var">&lt;|&gt;</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194000"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194001"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-342"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194003"><a href="#local-6989586621679194003"><span class="hs-identifier">xy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194001"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194002"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">]</span><span>
</span><a name="line-343"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194004"><a href="#local-6989586621679194004"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679194003"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-344"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194004"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679194004"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-number">60</span><span>
</span><a name="line-345"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194000"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="#local-6989586621679194003"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-346"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194004"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- | Creates an input with @type=&quot;email&quot;@. Yesod will validate the email's correctness according to RFC5322 and canonicalize it by removing comments and whitespace (see &quot;Text.Email.Validate&quot;).</span><span>
</span><a name="line-349"></a><span class="hs-identifier">emailField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193639"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193639"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-350"></a><a name="emailField"><a href="Yesod.Form.Fields.html#emailField"><span class="hs-identifier">emailField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-351"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-352"></a><span>        </span><span class="hs-glyph">\</span><a name="local-6989586621679194104"><a href="#local-6989586621679194104"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-353"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Email.canonicalizeEmail</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">encodeUtf8</span><span> </span><a href="#local-6989586621679194104"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-354"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194105"><a href="#local-6989586621679194105"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span> </span><span class="hs-identifier hs-var">lenientDecode</span><span> </span><a href="#local-6989586621679194105"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-355"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidEmail"><span class="hs-identifier hs-var">MsgInvalidEmail</span></a><span> </span><a href="#local-6989586621679194104"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-356"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194106"><a href="#local-6989586621679194106"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194107"><a href="#local-6989586621679194107"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194108"><a href="#local-6989586621679194108"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194109"><a href="#local-6989586621679194109"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194110"><a href="#local-6989586621679194110"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;email&quot; :isReq:required=&quot;&quot; value=&quot;#{either id id val}&quot;&gt;
|]</span><span>
</span><a name="line-360"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-361"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-- | Creates an input with @type=&quot;email&quot;@ with the &lt;http://w3c.github.io/html/sec-forms.html#the-multiple-attribute multiple&gt; attribute; browsers might implement this as taking a comma separated list of emails. Each email address is validated as described in 'emailField'.</span><span>
</span><a name="line-364"></a><span class="hs-comment">--</span><span>
</span><a name="line-365"></a><span class="hs-comment">-- Since 1.3.7</span><span>
</span><a name="line-366"></a><span class="hs-identifier">multiEmailField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193638"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193638"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193638"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">]</span><span>
</span><a name="line-367"></a><a name="multiEmailField"><a href="Yesod.Form.Fields.html#multiEmailField"><span class="hs-identifier">multiEmailField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-368"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-369"></a><span>        </span><span class="hs-glyph">\</span><a name="local-6989586621679194122"><a href="#local-6989586621679194122"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-370"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194123"><a href="#local-6989586621679194123"><span class="hs-identifier">addrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679194116"><span class="hs-identifier hs-var">validate</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">splitOn</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><a href="#local-6989586621679194122"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-371"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">partitionEithers</span><span> </span><a href="#local-6989586621679194123"><span class="hs-identifier hs-var">addrs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-372"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194124"><a href="#local-6989586621679194124"><span class="hs-identifier">good</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679194124"><span class="hs-identifier hs-var">good</span></a><span>
</span><a name="line-373"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679194125"><a href="#local-6989586621679194125"><span class="hs-identifier">bad</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidEmail"><span class="hs-identifier hs-var">MsgInvalidEmail</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194117"><span class="hs-identifier hs-var">cat</span></a><span> </span><a href="#local-6989586621679194125"><span class="hs-identifier hs-var">bad</span></a><span>
</span><a name="line-374"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194126"><a href="#local-6989586621679194126"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194127"><a href="#local-6989586621679194127"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194128"><a href="#local-6989586621679194128"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194129"><a href="#local-6989586621679194129"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194130"><a href="#local-6989586621679194130"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;email&quot; multiple :isReq:required=&quot;&quot; value=&quot;#{either id cat val}&quot;&gt;
|]</span><span>
</span><a name="line-378"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-379"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-380"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>        </span><span class="hs-comment">-- report offending address along with error</span><span>
</span><a name="line-382"></a><span>        </span><a name="local-6989586621679194116"><a href="#local-6989586621679194116"><span class="hs-identifier">validate</span></a></a><span> </span><a name="local-6989586621679194119"><a href="#local-6989586621679194119"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Email.validate</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">encodeUtf8</span><span> </span><a href="#local-6989586621679194119"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-383"></a><span>                        </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679194120"><a href="#local-6989586621679194120"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">T.concat</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194119"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot; (&quot;</span><span class="hs-special">,</span><span>  </span><span class="hs-identifier hs-var">pack</span><span> </span><a href="#local-6989586621679194120"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-384"></a><span>                        </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679194121"><a href="#local-6989586621679194121"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194118"><span class="hs-identifier hs-var">emailToText</span></a><span> </span><a href="#local-6989586621679194121"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-385"></a><span>        </span><a name="local-6989586621679194117"><a href="#local-6989586621679194117"><span class="hs-identifier">cat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">intercalate</span><span> </span><span class="hs-string">&quot;, &quot;</span><span>
</span><a name="line-386"></a><span>        </span><a name="local-6989586621679194118"><a href="#local-6989586621679194118"><span class="hs-identifier">emailToText</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">decodeUtf8With</span><span> </span><span class="hs-identifier hs-var">lenientDecode</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Email.toByteString</span><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-keyword">type</span><span> </span><a name="AutoFocus"><a href="Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier">AutoFocus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-389"></a><span class="hs-comment">-- | Creates an input with @type=&quot;search&quot;@. For &lt;http://caniuse.com/#search=autofocus browsers without autofocus support&gt;, a JS fallback is used if @AutoFocus@ is true.</span><span>
</span><a name="line-390"></a><span class="hs-identifier">searchField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193637"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193637"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Fields.html#AutoFocus"><span class="hs-identifier hs-type">AutoFocus</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193637"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-391"></a><a name="searchField"><a href="Yesod.Form.Fields.html#searchField"><span class="hs-identifier">searchField</span></a></a><span> </span><a name="local-6989586621679194136"><a href="#local-6989586621679194136"><span class="hs-identifier">autoFocus</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-392"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-identifier hs-var">Right</span><span>
</span><a name="line-393"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194137"><a href="#local-6989586621679194137"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194138"><a href="#local-6989586621679194138"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194139"><a href="#local-6989586621679194139"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194140"><a href="#local-6989586621679194140"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194141"><a href="#local-6989586621679194141"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-394"></a><span>        </span><span class="">[whamlet|
$newline never
&lt;input id=&quot;#{theId}&quot; name=&quot;#{name}&quot; *{attrs} type=&quot;search&quot; :isReq:required=&quot;&quot; :autoFocus:autofocus=&quot;&quot; value=&quot;#{either id id val}&quot;&gt;
|]</span><span>
</span><a name="line-398"></a><span>        </span><span class="hs-identifier hs-var">when</span><span> </span><a href="#local-6989586621679194136"><span class="hs-identifier hs-var">autoFocus</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-399"></a><span>          </span><span class="hs-comment">-- we want this javascript to be placed immediately after the field</span><span>
</span><a name="line-400"></a><span>          </span><span class="">[whamlet|
$newline never
&lt;script&gt;if (!('autofocus' in document.createElement('input'))) {document.getElementById('#{theId}').focus();}
|]</span><span>
</span><a name="line-404"></a><span>          </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[cassius|
            ##{theId}
              -webkit-appearance: textfield
            |]</span><span>
</span><a name="line-408"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-409"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-410"></a><span class="hs-comment">-- | Creates an input with @type=&quot;url&quot;@, validating the URL according to RFC3986.</span><span>
</span><a name="line-411"></a><span class="hs-identifier">urlField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193636"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193636"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193636"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-412"></a><a name="urlField"><a href="Yesod.Form.Fields.html#urlField"><span class="hs-identifier">urlField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-413"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Functions.html#parseHelper"><span class="hs-identifier hs-var">parseHelper</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194239"><a href="#local-6989586621679194239"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-414"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">parseURI</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679194239"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-415"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidUrl"><span class="hs-identifier hs-var">MsgInvalidUrl</span></a><span> </span><a href="#local-6989586621679194239"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-416"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679194239"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-417"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194240"><a href="#local-6989586621679194240"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194241"><a href="#local-6989586621679194241"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194242"><a href="#local-6989586621679194242"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194243"><a href="#local-6989586621679194243"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194244"><a href="#local-6989586621679194244"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-418"></a><span>        </span><span class="">[whamlet|&lt;input ##{theId} name=#{name} *{attrs} type=url :isReq:required value=#{either id id val}&gt;|]</span><span>
</span><a name="line-419"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-420"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">-- | Creates a @\&lt;select&gt;@ tag for selecting one option. Example usage:</span><span>
</span><a name="line-423"></a><span class="hs-comment">--</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- &gt; areq (selectFieldList [(&quot;Value 1&quot; :: Text, &quot;value1&quot;),(&quot;Value 2&quot;, &quot;value2&quot;)]) &quot;Which value?&quot; Nothing</span><span>
</span><a name="line-425"></a><span class="hs-identifier">selectFieldList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193633"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193634"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193634"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193635"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679193635"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193633"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-427"></a><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193634"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193633"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-428"></a><a name="selectFieldList"><a href="Yesod.Form.Fields.html#selectFieldList"><span class="hs-identifier">selectFieldList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#selectField"><span class="hs-identifier hs-var">selectField</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a name="line-429"></a><span>
</span><a name="line-430"></a><span class="hs-comment">-- | Creates a @\&lt;select&gt;@ tag for selecting one option. Example usage:</span><span>
</span><a name="line-431"></a><span class="hs-comment">--</span><span>
</span><a name="line-432"></a><span class="hs-comment">-- &gt; areq (selectField $ optionsPairs [(MsgValue1, &quot;value1&quot;),(MsgValue2, &quot;value2&quot;)]) &quot;Which value?&quot; Nothing</span><span>
</span><a name="line-433"></a><span class="hs-identifier">selectField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193632"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a name="line-434"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193632"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193631"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193632"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193631"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-436"></a><a name="selectField"><a href="Yesod.Form.Fields.html#selectField"><span class="hs-identifier">selectField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#selectFieldHelper"><span class="hs-identifier hs-var">selectFieldHelper</span></a><span>
</span><a name="line-437"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194249"><a href="#local-6989586621679194249"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194250"><a href="#local-6989586621679194250"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194251"><a href="#local-6989586621679194251"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194252"><a href="#local-6989586621679194252"><span class="hs-identifier">inside</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;select ##{theId} name=#{name} *{attrs}&gt;^{inside}
|]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- outside</span><span>
</span><a name="line-441"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194257"><a href="#local-6989586621679194257"><span class="hs-identifier">_theId</span></a></a><span> </span><a name="local-6989586621679194258"><a href="#local-6989586621679194258"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679194259"><a href="#local-6989586621679194259"><span class="hs-identifier">isSel</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;option value=none :isSel:selected&gt;_{MsgSelectNone}
|]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- onOpt</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194265"><a href="#local-6989586621679194265"><span class="hs-identifier">_theId</span></a></a><span> </span><a name="local-6989586621679194266"><a href="#local-6989586621679194266"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679194267"><a href="#local-6989586621679194267"><span class="hs-identifier">_attrs</span></a></a><span> </span><a name="local-6989586621679194268"><a href="#local-6989586621679194268"><span class="hs-identifier">value</span></a></a><span> </span><a name="local-6989586621679194269"><a href="#local-6989586621679194269"><span class="hs-identifier">isSel</span></a></a><span> </span><a name="local-6989586621679194270"><a href="#local-6989586621679194270"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;option value=#{value} :isSel:selected&gt;#{text}
|]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- inside</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span class="hs-comment">-- | Creates a @\&lt;select&gt;@ tag for selecting multiple options.</span><span>
</span><a name="line-451"></a><span class="hs-identifier">multiSelectFieldList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193628"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193629"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193630"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-452"></a><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679193630"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193628"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-453"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193629"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193628"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-454"></a><a name="multiSelectFieldList"><a href="Yesod.Form.Fields.html#multiSelectFieldList"><span class="hs-identifier">multiSelectFieldList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#multiSelectField"><span class="hs-identifier hs-var">multiSelectField</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span class="hs-comment">-- | Creates a @\&lt;select&gt;@ tag for selecting multiple options.</span><span>
</span><a name="line-457"></a><span class="hs-identifier">multiSelectField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193626"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-458"></a><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193627"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-459"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193627"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-460"></a><a name="multiSelectField"><a href="Yesod.Form.Fields.html#multiSelectField"><span class="hs-identifier">multiSelectField</span></a></a><span> </span><a name="local-6989586621679194275"><a href="#local-6989586621679194275"><span class="hs-identifier">ioptlist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-461"></a><span>    </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span> </span><a href="#local-6989586621679194276"><span class="hs-identifier hs-var">parse</span></a><span> </span><a href="#local-6989586621679194277"><span class="hs-identifier hs-var">view</span></a><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-462"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-463"></a><span>    </span><a name="local-6989586621679194276"><a href="#local-6989586621679194276"><span class="hs-identifier">parse</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-464"></a><span>    </span><span class="hs-identifier">parse</span><span> </span><a name="local-6989586621679194278"><a href="#local-6989586621679194278"><span class="hs-identifier">optlist</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-465"></a><span>        </span><a name="local-6989586621679194279"><a href="#local-6989586621679194279"><span class="hs-identifier">mapopt</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">olReadExternal</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679194275"><span class="hs-identifier hs-var">ioptlist</span></a><span>
</span><a name="line-466"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="#local-6989586621679194279"><span class="hs-identifier hs-var">mapopt</span></a><span> </span><a href="#local-6989586621679194278"><span class="hs-identifier hs-var">optlist</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-467"></a><span>             </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;Error parsing values&quot;</span><span>
</span><a name="line-468"></a><span>             </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194280"><a href="#local-6989586621679194280"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679194280"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-469"></a><span>
</span><a name="line-470"></a><span>    </span><a name="local-6989586621679194277"><a href="#local-6989586621679194277"><span class="hs-identifier">view</span></a></a><span> </span><a name="local-6989586621679194281"><a href="#local-6989586621679194281"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194282"><a href="#local-6989586621679194282"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194283"><a href="#local-6989586621679194283"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194284"><a href="#local-6989586621679194284"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194285"><a href="#local-6989586621679194285"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-471"></a><span>        </span><a name="local-6989586621679194289"><a href="#local-6989586621679194289"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier">olOptions</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">handlerToWidget</span><span> </span><a href="#local-6989586621679194275"><span class="hs-identifier hs-var">ioptlist</span></a><span>
</span><a name="line-472"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194290"><a href="#local-6989586621679194290"><span class="hs-identifier">selOpts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-operator hs-var">&amp;&amp;&amp;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194286"><span class="hs-identifier hs-var">optselected</span></a><span> </span><a href="#local-6989586621679194284"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194289"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-473"></a><span>        </span><span class="">[whamlet|
            &lt;select ##{theId} name=#{name} :isReq:required multiple *{attrs}&gt;
                $forall (opt, optsel) &lt;- selOpts
                    &lt;option value=#{optionExternalValue opt} :optsel:selected&gt;#{optionDisplay opt}
                |]</span><span>
</span><a name="line-478"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-479"></a><span>            </span><a name="local-6989586621679194286"><a href="#local-6989586621679194286"><span class="hs-identifier">optselected</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-480"></a><span>            </span><span class="hs-identifier">optselected</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679194287"><a href="#local-6989586621679194287"><span class="hs-identifier">vals</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194288"><a href="#local-6989586621679194288"><span class="hs-identifier">opt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">optionInternalValue</span><span> </span><a href="#local-6989586621679194288"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194287"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">-- | Creates an input with @type=&quot;radio&quot;@ for selecting one option.</span><span>
</span><a name="line-483"></a><span class="hs-identifier">radioFieldList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193623"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193624"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193624"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193625"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-484"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679193625"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193623"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-485"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193624"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193623"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-486"></a><a name="radioFieldList"><a href="Yesod.Form.Fields.html#radioFieldList"><span class="hs-identifier">radioFieldList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#radioField"><span class="hs-identifier hs-var">radioField</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">-- | Creates an input with @type=&quot;checkbox&quot;@ for selecting multiple options.</span><span>
</span><a name="line-489"></a><span class="hs-identifier">checkboxesFieldList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193620"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193621"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193622"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679193622"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193620"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-490"></a><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193621"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193620"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-491"></a><a name="checkboxesFieldList"><a href="Yesod.Form.Fields.html#checkboxesFieldList"><span class="hs-identifier">checkboxesFieldList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#checkboxesField"><span class="hs-identifier hs-var">checkboxesField</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span>
</span><a name="line-492"></a><span>
</span><a name="line-493"></a><span class="hs-comment">-- | Creates an input with @type=&quot;checkbox&quot;@ for selecting multiple options.</span><span>
</span><a name="line-494"></a><span class="hs-identifier">checkboxesField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193618"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-495"></a><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193619"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193618"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193619"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679193618"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-497"></a><a name="checkboxesField"><a href="Yesod.Form.Fields.html#checkboxesField"><span class="hs-identifier">checkboxesField</span></a></a><span> </span><a name="local-6989586621679194297"><a href="#local-6989586621679194297"><span class="hs-identifier">ioptlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#multiSelectField"><span class="hs-identifier hs-var">multiSelectField</span></a><span> </span><a href="#local-6989586621679194297"><span class="hs-identifier hs-var">ioptlist</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-499"></a><span>        </span><span class="hs-glyph">\</span><a name="local-6989586621679194298"><a href="#local-6989586621679194298"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194299"><a href="#local-6989586621679194299"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194300"><a href="#local-6989586621679194300"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194301"><a href="#local-6989586621679194301"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194302"><a href="#local-6989586621679194302"><span class="hs-identifier">_isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-500"></a><span>            </span><a name="local-6989586621679194303"><a href="#local-6989586621679194303"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier">olOptions</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">handlerToWidget</span><span> </span><a href="#local-6989586621679194297"><span class="hs-identifier hs-var">ioptlist</span></a><span>
</span><a name="line-501"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194304"><a href="#local-6989586621679194304"><span class="hs-identifier">optselected</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-502"></a><span>                </span><span class="hs-identifier">optselected</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679194305"><a href="#local-6989586621679194305"><span class="hs-identifier">vals</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194306"><a href="#local-6989586621679194306"><span class="hs-identifier">opt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">optionInternalValue</span><span> </span><a href="#local-6989586621679194306"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194305"><span class="hs-identifier hs-var">vals</span></a><span>
</span><a name="line-503"></a><span>            </span><span class="">[whamlet|
                &lt;span ##{theId}&gt;
                    $forall opt &lt;- opts
                        &lt;label&gt;
                            &lt;input type=checkbox name=#{name} value=#{optionExternalValue opt} *{attrs} :optselected val opt:checked&gt;
                            #{optionDisplay opt}
                |]</span><span>
</span><a name="line-510"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-511"></a><span class="hs-comment">-- | Creates an input with @type=&quot;radio&quot;@ for selecting one option.</span><span>
</span><a name="line-512"></a><span class="hs-identifier">radioField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193616"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193617"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a name="line-513"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193617"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193616"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-514"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193617"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193616"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-515"></a><a name="radioField"><a href="Yesod.Form.Fields.html#radioField"><span class="hs-identifier">radioField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#selectFieldHelper"><span class="hs-identifier hs-var">selectFieldHelper</span></a><span>
</span><a name="line-516"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194312"><a href="#local-6989586621679194312"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194313"><a href="#local-6989586621679194313"><span class="hs-identifier">_name</span></a></a><span> </span><a name="local-6989586621679194314"><a href="#local-6989586621679194314"><span class="hs-identifier">_attrs</span></a></a><span> </span><a name="local-6989586621679194315"><a href="#local-6989586621679194315"><span class="hs-identifier">inside</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;div ##{theId}&gt;^{inside}
|]</span><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194320"><a href="#local-6989586621679194320"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194321"><a href="#local-6989586621679194321"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194322"><a href="#local-6989586621679194322"><span class="hs-identifier">isSel</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;label .radio for=#{theId}-none&gt;
    &lt;div&gt;
        &lt;input id=#{theId}-none type=radio name=#{name} value=none :isSel:checked&gt;
        _{MsgSelectNone}
|]</span><span class="hs-special">)</span><span>
</span><a name="line-527"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194328"><a href="#local-6989586621679194328"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194329"><a href="#local-6989586621679194329"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194330"><a href="#local-6989586621679194330"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194331"><a href="#local-6989586621679194331"><span class="hs-identifier">value</span></a></a><span> </span><a name="local-6989586621679194332"><a href="#local-6989586621679194332"><span class="hs-identifier">isSel</span></a></a><span> </span><a name="local-6989586621679194333"><a href="#local-6989586621679194333"><span class="hs-identifier">text</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;label .radio for=#{theId}-#{value}&gt;
    &lt;div&gt;
        &lt;input id=#{theId}-#{value} type=radio name=#{name} value=#{value} :isSel:checked *{attrs}&gt;
        \#{text}
|]</span><span class="hs-special">)</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-comment">-- | Creates a group of radio buttons to answer the question given in the message. Radio buttons are used to allow differentiating between an empty response (@Nothing@) and a no response (@Just False@). Consider using the simpler 'checkBoxField' if you don't need to make this distinction.</span><span>
</span><a name="line-536"></a><span class="hs-comment">--</span><span>
</span><a name="line-537"></a><span class="hs-comment">-- If this field is optional, the first radio button is labeled &quot;\&lt;None&gt;&quot;, the second \&quot;Yes&quot; and the third \&quot;No&quot;.</span><span>
</span><a name="line-538"></a><span class="hs-comment">--</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- If this field is required, the first radio button is labeled \&quot;Yes&quot; and the second \&quot;No&quot;. </span><span>
</span><a name="line-540"></a><span class="hs-comment">--</span><span>
</span><a name="line-541"></a><span class="hs-comment">-- (Exact label titles will depend on localization).</span><span>
</span><a name="line-542"></a><span class="hs-identifier">boolField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193615"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193615"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193615"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-543"></a><a name="boolField"><a href="Yesod.Form.Fields.html#boolField"><span class="hs-identifier">boolField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-544"></a><span>      </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194342"><a href="#local-6989586621679194342"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194338"><span class="hs-identifier hs-var">boolParser</span></a><span> </span><a href="#local-6989586621679194342"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-545"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194343"><a href="#local-6989586621679194343"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194344"><a href="#local-6989586621679194344"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194345"><a href="#local-6989586621679194345"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194346"><a href="#local-6989586621679194346"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194347"><a href="#local-6989586621679194347"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
  $if not isReq
      &lt;input id=#{theId}-none *{attrs} type=radio name=#{name} value=none checked&gt;
      &lt;label for=#{theId}-none&gt;_{MsgSelectNone}


&lt;input id=#{theId}-yes *{attrs} type=radio name=#{name} value=yes :showVal id val:checked&gt;
&lt;label for=#{theId}-yes&gt;_{MsgBoolYes}

&lt;input id=#{theId}-no *{attrs} type=radio name=#{name} value=no :showVal not val:checked&gt;
&lt;label for=#{theId}-no&gt;_{MsgBoolNo}
|]</span><span>
</span><a name="line-558"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-559"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-560"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-561"></a><span>    </span><a name="local-6989586621679194338"><a href="#local-6989586621679194338"><span class="hs-identifier">boolParser</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-562"></a><span>    </span><span class="hs-identifier">boolParser</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194340"><a href="#local-6989586621679194340"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194340"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-563"></a><span>      </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-564"></a><span>      </span><span class="hs-string">&quot;none&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-565"></a><span>      </span><span class="hs-string">&quot;yes&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-566"></a><span>      </span><span class="hs-string">&quot;on&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-567"></a><span>      </span><span class="hs-string">&quot;no&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-568"></a><span>      </span><span class="hs-string">&quot;true&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-569"></a><span>      </span><span class="hs-string">&quot;false&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-570"></a><span>      </span><a name="local-6989586621679194341"><a href="#local-6989586621679194341"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SomeMessage</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidBool"><span class="hs-identifier hs-var">MsgInvalidBool</span></a><span> </span><a href="#local-6989586621679194341"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-571"></a><span>    </span><a name="local-6989586621679194339"><a href="#local-6989586621679194339"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span>
</span><a name="line-573"></a><span class="hs-comment">-- | Creates an input with @type=&quot;checkbox&quot;@. </span><span>
</span><a name="line-574"></a><span class="hs-comment">--   While the default @'boolField'@ implements a radio button so you</span><span>
</span><a name="line-575"></a><span class="hs-comment">--   can differentiate between an empty response (@Nothing@) and a no</span><span>
</span><a name="line-576"></a><span class="hs-comment">--   response (@Just False@), this simpler checkbox field returns an empty</span><span>
</span><a name="line-577"></a><span class="hs-comment">--   response as @Just False@.</span><span>
</span><a name="line-578"></a><span class="hs-comment">--</span><span>
</span><a name="line-579"></a><span class="hs-comment">--   Note that this makes the field always optional.</span><span>
</span><a name="line-580"></a><span class="hs-comment">--</span><span>
</span><a name="line-581"></a><span class="hs-identifier">checkBoxField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193614"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193614"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-582"></a><a name="checkBoxField"><a href="Yesod.Form.Fields.html#checkBoxField"><span class="hs-identifier">checkBoxField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-583"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194358"><a href="#local-6989586621679194358"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194355"><span class="hs-identifier hs-var">checkBoxParser</span></a><span> </span><a href="#local-6989586621679194358"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-584"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194359"><a href="#local-6989586621679194359"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194360"><a href="#local-6989586621679194360"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194361"><a href="#local-6989586621679194361"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194362"><a href="#local-6989586621679194362"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="">[whamlet|
$newline never
&lt;input id=#{theId} *{attrs} type=checkbox name=#{name} value=yes :showVal id val:checked&gt;
|]</span><span>
</span><a name="line-588"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-589"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-592"></a><span>        </span><a name="local-6989586621679194355"><a href="#local-6989586621679194355"><span class="hs-identifier">checkBoxParser</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-593"></a><span>        </span><span class="hs-identifier">checkBoxParser</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194357"><a href="#local-6989586621679194357"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194357"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-594"></a><span>            </span><span class="hs-string">&quot;yes&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-595"></a><span>            </span><span class="hs-string">&quot;on&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-596"></a><span>            </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span>        </span><a name="local-6989586621679194356"><a href="#local-6989586621679194356"><span class="hs-identifier">showVal</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-comment">-- | A structure holding a list of options. Typically you can use a convenience function like 'mkOptionList' or 'optionsPairs' instead of creating this directly.</span><span>
</span><a name="line-601"></a><span class="hs-keyword">data</span><span> </span><a name="OptionList"><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier">OptionList</span></a></a><span> </span><a name="local-6989586621679184911"><a href="#local-6989586621679184911"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OptionList"><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier">OptionList</span></a></a><span>
</span><a name="line-602"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="olOptions"><a href="Yesod.Form.Fields.html#olOptions"><span class="hs-identifier">olOptions</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-type">Option</span></a><span> </span><a href="#local-6989586621679184911"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-603"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="olReadExternal"><a href="Yesod.Form.Fields.html#olReadExternal"><span class="hs-identifier">olReadExternal</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679184911"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ A function mapping from the form's value ('optionExternalValue') to the selected Haskell value ('optionInternalValue').</span><span>
</span><a name="line-604"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-605"></a><span>
</span><a name="line-606"></a><span class="hs-comment">-- | Since 1.4.6</span><span>
</span><a name="line-607"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-608"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679191112"><a href="#local-6989586621679191112"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-var">OptionList</span></a><span> </span><a name="local-6989586621679191113"><a href="#local-6989586621679191113"><span class="hs-identifier">options</span></a></a><span> </span><a name="local-6989586621679191114"><a href="#local-6989586621679191114"><span class="hs-identifier">readExternal</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-609"></a><span>      </span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-var">OptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fmap</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679191112"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679191113"><span class="hs-identifier hs-var">options</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679191112"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679191114"><span class="hs-identifier hs-var">readExternal</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>
</span><a name="line-611"></a><span class="hs-comment">-- | Creates an 'OptionList', using a 'Map' to implement the 'olReadExternal' function.</span><span>
</span><a name="line-612"></a><span class="hs-identifier">mkOptionList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-type">Option</span></a><span> </span><a href="#local-6989586621679193613"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193613"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-613"></a><a name="mkOptionList"><a href="Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier">mkOptionList</span></a></a><span> </span><a name="local-6989586621679194367"><a href="#local-6989586621679194367"><span class="hs-identifier">os</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-var">OptionList</span></a><span>
</span><a name="line-614"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">olOptions</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194367"><span class="hs-identifier hs-var">os</span></a><span>
</span><a name="line-615"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">olReadExternal</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map.fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">optionExternalValue</span><span> </span><span class="hs-operator hs-var">&amp;&amp;&amp;</span><span> </span><span class="hs-identifier">optionInternalValue</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194367"><span class="hs-identifier hs-var">os</span></a><span>
</span><a name="line-616"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-617"></a><span>
</span><a name="line-618"></a><span class="hs-keyword">data</span><span> </span><a name="Option"><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier">Option</span></a></a><span> </span><a name="local-6989586621679184910"><a href="#local-6989586621679184910"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Option"><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier">Option</span></a></a><span>
</span><a name="line-619"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="optionDisplay"><a href="Yesod.Form.Fields.html#optionDisplay"><span class="hs-identifier">optionDisplay</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-comment">-- ^ The user-facing label.</span><span>
</span><a name="line-620"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="optionInternalValue"><a href="Yesod.Form.Fields.html#optionInternalValue"><span class="hs-identifier">optionInternalValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679184910"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ The Haskell value being selected.</span><span>
</span><a name="line-621"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="optionExternalValue"><a href="Yesod.Form.Fields.html#optionExternalValue"><span class="hs-identifier">optionExternalValue</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-comment">-- ^ The representation of this value stored in the form.</span><span>
</span><a name="line-622"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-623"></a><span>
</span><a name="line-624"></a><span class="hs-comment">-- | Since 1.4.6</span><span>
</span><a name="line-625"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-type">Option</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-626"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679191108"><a href="#local-6989586621679191108"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-var">Option</span></a><span> </span><a name="local-6989586621679191109"><a href="#local-6989586621679191109"><span class="hs-identifier">display</span></a></a><span> </span><a name="local-6989586621679191110"><a href="#local-6989586621679191110"><span class="hs-identifier">internal</span></a></a><span> </span><a name="local-6989586621679191111"><a href="#local-6989586621679191111"><span class="hs-identifier">external</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-var">Option</span></a><span> </span><a href="#local-6989586621679191109"><span class="hs-identifier hs-var">display</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679191108"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679191110"><span class="hs-identifier hs-var">internal</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679191111"><span class="hs-identifier hs-var">external</span></a><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-comment">-- | Creates an 'OptionList' from a list of (display-value, internal value) pairs.</span><span>
</span><a name="line-629"></a><span class="hs-identifier">optionsPairs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadHandler</span><span> </span><a href="#local-6989586621679193610"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193610"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193611"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679193611"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679193612"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193610"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193612"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-631"></a><a name="optionsPairs"><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier">optionsPairs</span></a></a><span> </span><a name="local-6989586621679194368"><a href="#local-6989586621679194368"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-632"></a><span>  </span><a name="local-6989586621679194369"><a href="#local-6989586621679194369"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getMessageRender</span><span>
</span><a name="line-633"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194370"><a href="#local-6989586621679194370"><span class="hs-identifier">mkOption</span></a></a><span> </span><a name="local-6989586621679194371"><a href="#local-6989586621679194371"><span class="hs-identifier">external</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679194372"><a href="#local-6989586621679194372"><span class="hs-identifier">display</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194373"><a href="#local-6989586621679194373"><span class="hs-identifier">internal</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-634"></a><span>          </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-var">Option</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">optionDisplay</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194369"><span class="hs-identifier hs-var">mr</span></a><span> </span><a href="#local-6989586621679194372"><span class="hs-identifier hs-var">display</span></a><span>
</span><a name="line-635"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionInternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194373"><span class="hs-identifier hs-var">internal</span></a><span>
</span><a name="line-636"></a><span>                 </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679194371"><span class="hs-identifier hs-var">external</span></a><span>
</span><a name="line-637"></a><span>                 </span><span class="hs-special">}</span><span>
</span><a name="line-638"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier hs-var">mkOptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679194370"><span class="hs-identifier hs-var">mkOption</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679194368"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span>
</span><a name="line-639"></a><span>
</span><a name="line-640"></a><span class="hs-comment">-- | Creates an 'OptionList' from an 'Enum', using its 'Show' instance for the user-facing value.</span><span>
</span><a name="line-641"></a><span class="hs-identifier">optionsEnum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadHandler</span><span> </span><a href="#local-6989586621679193608"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679193609"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Enum</span><span> </span><a href="#local-6989586621679193609"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="#local-6989586621679193609"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679193608"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193609"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-642"></a><a name="optionsEnum"><a href="Yesod.Form.Fields.html#optionsEnum"><span class="hs-identifier">optionsEnum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#optionsPairs"><span class="hs-identifier hs-var">optionsPairs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679194374"><a href="#local-6989586621679194374"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679194374"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194374"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">minBound</span><span class="hs-glyph">..</span><span class="hs-identifier hs-var">maxBound</span><span class="hs-special">]</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-comment">-- | Selects a list of 'Entity's with the given 'Filter' and 'SelectOpt's. The @(a -&gt; msg)@ function is then used to derive the display value for an 'OptionList'. Example usage:</span><span>
</span><a name="line-645"></a><span class="hs-comment">--</span><span>
</span><a name="line-646"></a><span class="hs-comment">-- &gt; Country</span><span>
</span><a name="line-647"></a><span class="hs-comment">-- &gt;    name Text</span><span>
</span><a name="line-648"></a><span class="hs-comment">-- &gt;    deriving Eq -- Must derive Eq</span><span>
</span><a name="line-649"></a><span class="hs-comment">--</span><span>
</span><a name="line-650"></a><span class="hs-comment">-- &gt; data CountryForm = CountryForm</span><span>
</span><a name="line-651"></a><span class="hs-comment">-- &gt;   { country :: Entity Country</span><span>
</span><a name="line-652"></a><span class="hs-comment">-- &gt;   }</span><span>
</span><a name="line-653"></a><span class="hs-comment">-- &gt;</span><span>
</span><a name="line-654"></a><span class="hs-comment">-- &gt; countryNameForm :: AForm Handler CountryForm</span><span>
</span><a name="line-655"></a><span class="hs-comment">-- &gt; countryNameForm = CountryForm</span><span>
</span><a name="line-656"></a><span class="hs-comment">-- &gt;         &lt;$&gt; areq (selectField countries) &quot;Which country do you live in?&quot; Nothing</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- &gt;         where</span><span>
</span><a name="line-658"></a><span class="hs-comment">-- &gt;           countries = optionsPersist [] [Asc CountryName] countryName</span><span>
</span><a name="line-659"></a><span class="hs-cpp">#if MIN_VERSION_persistent(2,5,0)
</span><span class="hs-identifier">optionsPersist</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">YesodPersist</span><span> </span><a href="#local-6989586621679193604"><span class="hs-identifier hs-type">site</span></a><span>
</span><a name="line-661"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistQueryRead</span><span> </span><a href="#local-6989586621679193605"><span class="hs-identifier hs-type">backend</span></a><span>
</span><a name="line-662"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PathPiece</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Key</span><span> </span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-663"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193604"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193607"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-664"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">YesodPersistBackend</span><span> </span><a href="#local-6989586621679193604"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679193605"><span class="hs-identifier hs-type">backend</span></a><span>
</span><a name="line-665"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistRecordBackend</span><span> </span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679193605"><span class="hs-identifier hs-type">backend</span></a><span>
</span><a name="line-666"></a><span>                  </span><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Filter</span><span> </span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-668"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">SelectOpt</span><span> </span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-669"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193607"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-670"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193604"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Entity</span><span> </span><a href="#local-6989586621679193606"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-671"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">optionsPersist</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier">YesodPersist</span><span> </span><span class="hs-identifier">site</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistEntity</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-673"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistQuery</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PersistEntityBackend</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-674"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PathPiece</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Key</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-675"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">RenderMessage</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-identifier">msg</span><span>
</span><a name="line-676"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">YesodPersistBackend</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier">PersistEntityBackend</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-677"></a><span>                  </span><span class="hs-special">)</span><span>
</span><a name="line-678"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Filter</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-679"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SelectOpt</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-680"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><a name="line-681"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HandlerFor</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">OptionList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Entity</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-682"></a><span class="hs-cpp">#endif
</span><a name="optionsPersist"><a href="Yesod.Form.Fields.html#optionsPersist"><span class="hs-identifier">optionsPersist</span></a></a><span> </span><a name="local-6989586621679194375"><a href="#local-6989586621679194375"><span class="hs-identifier">filts</span></a></a><span> </span><a name="local-6989586621679194376"><a href="#local-6989586621679194376"><span class="hs-identifier">ords</span></a></a><span> </span><a name="local-6989586621679194377"><a href="#local-6989586621679194377"><span class="hs-identifier">toDisplay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier hs-var">mkOptionList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-684"></a><span>    </span><a name="local-6989586621679194378"><a href="#local-6989586621679194378"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getMessageRender</span><span>
</span><a name="line-685"></a><span>    </span><a name="local-6989586621679194379"><a href="#local-6989586621679194379"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">runDB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">selectList</span><span> </span><a href="#local-6989586621679194375"><span class="hs-identifier hs-var">filts</span></a><span> </span><a href="#local-6989586621679194376"><span class="hs-identifier hs-var">ords</span></a><span>
</span><a name="line-686"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Entity</span><span> </span><a name="local-6989586621679194380"><a href="#local-6989586621679194380"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679194381"><a href="#local-6989586621679194381"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-var">Option</span></a><span>
</span><a name="line-687"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">optionDisplay</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194378"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194377"><span class="hs-identifier hs-var">toDisplay</span></a><span> </span><a href="#local-6989586621679194381"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-688"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionInternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Entity</span><span> </span><a href="#local-6989586621679194380"><span class="hs-identifier hs-var">key</span></a><span> </span><a href="#local-6989586621679194381"><span class="hs-identifier hs-var">value</span></a><span>
</span><a name="line-689"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toPathPiece</span><span> </span><a href="#local-6989586621679194380"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-690"></a><span>        </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194379"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-comment">-- | An alternative to 'optionsPersist' which returns just the 'Key' instead of</span><span>
</span><a name="line-693"></a><span class="hs-comment">-- the entire 'Entity'.</span><span>
</span><a name="line-694"></a><span class="hs-comment">--</span><span>
</span><a name="line-695"></a><span class="hs-comment">-- Since 1.3.2</span><span>
</span><a name="line-696"></a><span class="hs-cpp">#if MIN_VERSION_persistent(2,5,0)
</span><span class="hs-identifier">optionsPersistKey</span><span>
</span><a name="line-698"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">YesodPersist</span><span> </span><a href="#local-6989586621679193285"><span class="hs-identifier hs-type">site</span></a><span>
</span><a name="line-699"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistQueryRead</span><span> </span><a href="#local-6989586621679193286"><span class="hs-identifier hs-type">backend</span></a><span>
</span><a name="line-700"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PathPiece</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Key</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-701"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193285"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="#local-6989586621679193288"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-702"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">backend</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier hs-type">YesodPersistBackend</span><span> </span><a href="#local-6989586621679193285"><span class="hs-identifier hs-type">site</span></a><span>
</span><a name="line-703"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PersistRecordBackend</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679193286"><span class="hs-identifier hs-type">backend</span></a><span>
</span><a name="line-704"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-705"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Filter</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-706"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">SelectOpt</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-707"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679193288"><span class="hs-identifier hs-type">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-708"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193285"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Key</span><span> </span><a href="#local-6989586621679193287"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span class="hs-cpp">#else
</span><span class="hs-identifier">optionsPersistKey</span><span>
</span><a name="line-711"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">YesodPersist</span><span> </span><span class="hs-identifier">site</span><span>
</span><a name="line-712"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistEntity</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-713"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PersistQuery</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PersistEntityBackend</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-714"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">PathPiece</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Key</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">RenderMessage</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-identifier">msg</span><span>
</span><a name="line-716"></a><span>     </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">YesodPersistBackend</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-identifier">PersistEntityBackend</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-717"></a><span>     </span><span class="hs-special">)</span><span>
</span><a name="line-718"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Filter</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-719"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">SelectOpt</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-720"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span>
</span><a name="line-721"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">HandlerFor</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">OptionList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Key</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-722"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-724"></a><a name="optionsPersistKey"><a href="Yesod.Form.Fields.html#optionsPersistKey"><span class="hs-identifier">optionsPersistKey</span></a></a><span> </span><a name="local-6989586621679194382"><a href="#local-6989586621679194382"><span class="hs-identifier">filts</span></a></a><span> </span><a name="local-6989586621679194383"><a href="#local-6989586621679194383"><span class="hs-identifier">ords</span></a></a><span> </span><a name="local-6989586621679194384"><a href="#local-6989586621679194384"><span class="hs-identifier">toDisplay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Yesod.Form.Fields.html#mkOptionList"><span class="hs-identifier hs-var">mkOptionList</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-725"></a><span>    </span><a name="local-6989586621679194385"><a href="#local-6989586621679194385"><span class="hs-identifier">mr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getMessageRender</span><span>
</span><a name="line-726"></a><span>    </span><a name="local-6989586621679194386"><a href="#local-6989586621679194386"><span class="hs-identifier">pairs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">runDB</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">selectList</span><span> </span><a href="#local-6989586621679194382"><span class="hs-identifier hs-var">filts</span></a><span> </span><a href="#local-6989586621679194383"><span class="hs-identifier hs-var">ords</span></a><span>
</span><a name="line-727"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Entity</span><span> </span><a name="local-6989586621679194387"><a href="#local-6989586621679194387"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679194388"><a href="#local-6989586621679194388"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Fields.html#Option"><span class="hs-identifier hs-var">Option</span></a><span>
</span><a name="line-728"></a><span>        </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">optionDisplay</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194385"><span class="hs-identifier hs-var">mr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194384"><span class="hs-identifier hs-var">toDisplay</span></a><span> </span><a href="#local-6989586621679194388"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span>
</span><a name="line-729"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionInternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194387"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-730"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toPathPiece</span><span> </span><a href="#local-6989586621679194387"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-731"></a><span>        </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194386"><span class="hs-identifier hs-var">pairs</span></a><span>
</span><a name="line-732"></a><span>
</span><a name="line-733"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-734"></a><span class="hs-comment">-- A helper function for constucting 'selectField's. You may want to use this when you define your custom 'selectField's or 'radioField's.</span><span>
</span><a name="line-735"></a><span class="hs-comment">--</span><span>
</span><a name="line-736"></a><span class="hs-comment">-- @since 1.6.2</span><span>
</span><a name="line-737"></a><span class="hs-identifier">selectFieldHelper</span><span>
</span><a name="line-738"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679193283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a name="line-739"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WidgetFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WidgetFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Outermost part of the field</span><span>
</span><a name="line-740"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WidgetFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ An option for None if the field is optional</span><span>
</span><a name="line-741"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">WidgetFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Other options</span><span>
</span><a name="line-742"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Fields.html#OptionList"><span class="hs-identifier hs-type">OptionList</span></a><span> </span><a href="#local-6989586621679193283"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-743"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerFor</span><span> </span><a href="#local-6989586621679193284"><span class="hs-identifier hs-type">site</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679193283"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-744"></a><a name="selectFieldHelper"><a href="Yesod.Form.Fields.html#selectFieldHelper"><span class="hs-identifier">selectFieldHelper</span></a></a><span> </span><a name="local-6989586621679194389"><a href="#local-6989586621679194389"><span class="hs-identifier">outside</span></a></a><span> </span><a name="local-6989586621679194390"><a href="#local-6989586621679194390"><span class="hs-identifier">onOpt</span></a></a><span> </span><a name="local-6989586621679194391"><a href="#local-6989586621679194391"><span class="hs-identifier">inside</span></a></a><span> </span><a name="local-6989586621679194392"><a href="#local-6989586621679194392"><span class="hs-identifier">opts'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-745"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194402"><a href="#local-6989586621679194402"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-746"></a><span>        </span><a name="local-6989586621679194403"><a href="#local-6989586621679194403"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679194392"><span class="hs-identifier hs-var">opts'</span></a><span>
</span><a name="line-747"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194394"><span class="hs-identifier hs-var">selectParser</span></a><span> </span><a href="#local-6989586621679194403"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679194402"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-748"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194404"><a href="#local-6989586621679194404"><span class="hs-identifier">theId</span></a></a><span> </span><a name="local-6989586621679194405"><a href="#local-6989586621679194405"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194406"><a href="#local-6989586621679194406"><span class="hs-identifier">attrs</span></a></a><span> </span><a name="local-6989586621679194407"><a href="#local-6989586621679194407"><span class="hs-identifier">val</span></a></a><span> </span><a name="local-6989586621679194408"><a href="#local-6989586621679194408"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-749"></a><span>        </span><a name="local-6989586621679194409"><a href="#local-6989586621679194409"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier">olOptions</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">handlerToWidget</span><span> </span><a href="#local-6989586621679194392"><span class="hs-identifier hs-var">opts'</span></a><span>
</span><a name="line-750"></a><span>        </span><a href="#local-6989586621679194389"><span class="hs-identifier hs-var">outside</span></a><span> </span><a href="#local-6989586621679194404"><span class="hs-identifier hs-var">theId</span></a><span> </span><a href="#local-6989586621679194405"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679194406"><span class="hs-identifier hs-var">attrs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-751"></a><span>            </span><span class="hs-identifier hs-var">unless</span><span> </span><a href="#local-6989586621679194408"><span class="hs-identifier hs-var">isReq</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194390"><span class="hs-identifier hs-var">onOpt</span></a><span> </span><a href="#local-6989586621679194404"><span class="hs-identifier hs-var">theId</span></a><span> </span><a href="#local-6989586621679194405"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194393"><span class="hs-identifier hs-var">render</span></a><span> </span><a href="#local-6989586621679194409"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679194407"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><a href="#local-6989586621679194409"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-752"></a><span>            </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">mapM_</span><span> </span><a href="#local-6989586621679194409"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194410"><a href="#local-6989586621679194410"><span class="hs-identifier">opt</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679194391"><span class="hs-identifier hs-var">inside</span></a><span>
</span><a name="line-753"></a><span>                </span><a href="#local-6989586621679194404"><span class="hs-identifier hs-var">theId</span></a><span>
</span><a name="line-754"></a><span>                </span><a href="#local-6989586621679194405"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-755"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679194408"><span class="hs-identifier hs-var">isReq</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-string">&quot;required&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;required&quot;</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194406"><span class="hs-identifier hs-var">attrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-756"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">optionExternalValue</span><span> </span><a href="#local-6989586621679194410"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span>
</span><a name="line-757"></a><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679194393"><span class="hs-identifier hs-var">render</span></a><span> </span><a href="#local-6989586621679194409"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679194407"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><a href="#local-6989586621679194410"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">optionDisplay</span><span> </span><a href="#local-6989586621679194410"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span>
</span><a name="line-759"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#UrlEncoded"><span class="hs-identifier hs-var">UrlEncoded</span></a><span>
</span><a name="line-760"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-761"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-762"></a><span>    </span><a name="local-6989586621679194393"><a href="#local-6989586621679194393"><span class="hs-identifier">render</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679194395"><a href="#local-6989586621679194395"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194395"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-763"></a><span>    </span><span class="hs-identifier">render</span><span> </span><a name="local-6989586621679194396"><a href="#local-6989586621679194396"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679194397"><a href="#local-6989586621679194397"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-identifier">optionExternalValue</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679194397"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">optionInternalValue</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194396"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-764"></a><span>    </span><a name="local-6989586621679194394"><a href="#local-6989586621679194394"><span class="hs-identifier">selectParser</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-765"></a><span>    </span><span class="hs-identifier">selectParser</span><span> </span><a name="local-6989586621679194398"><a href="#local-6989586621679194398"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679194399"><a href="#local-6989586621679194399"><span class="hs-identifier">s</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194399"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-766"></a><span>            </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-767"></a><span>            </span><span class="hs-string">&quot;none&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-768"></a><span>            </span><a name="local-6989586621679194400"><a href="#local-6989586621679194400"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">olReadExternal</span><span> </span><a href="#local-6989586621679194398"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679194400"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-769"></a><span>                    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">SomeMessage</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Yesod.Form.Types.html#MsgInvalidEntry"><span class="hs-identifier hs-var">MsgInvalidEntry</span></a><span> </span><a href="#local-6989586621679194400"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-770"></a><span>                    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194401"><a href="#local-6989586621679194401"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679194401"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-771"></a><span>
</span><a name="line-772"></a><span class="hs-comment">-- | Creates an input with @type=&quot;file&quot;@.</span><span>
</span><a name="line-773"></a><span class="hs-identifier">fileField</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679193282"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-774"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-type">Field</span></a><span> </span><a href="#local-6989586621679193282"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FileInfo</span><span>
</span><a name="line-775"></a><a name="fileField"><a href="Yesod.Form.Fields.html#fileField"><span class="hs-identifier">fileField</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a><span>
</span><a name="line-776"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fieldParse</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679194411"><a href="#local-6989586621679194411"><span class="hs-identifier">files</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-777"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194411"><span class="hs-identifier hs-var">files</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-778"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-779"></a><span>            </span><a name="local-6989586621679194412"><a href="#local-6989586621679194412"><span class="hs-identifier">file</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679194412"><span class="hs-identifier hs-var">file</span></a><span>
</span><a name="line-780"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldView</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679194413"><a href="#local-6989586621679194413"><span class="hs-identifier">id'</span></a></a><span> </span><a name="local-6989586621679194414"><a href="#local-6989586621679194414"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679194415"><a href="#local-6989586621679194415"><span class="hs-identifier">attrs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679194416"><a href="#local-6989586621679194416"><span class="hs-identifier">isReq</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">toWidget</span><span> </span><span class="">[hamlet|
            &lt;input id=#{id'} name=#{name} *{attrs} type=file :isReq:required&gt;
        |]</span><span>
</span><a name="line-783"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fieldEnctype</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#Multipart"><span class="hs-identifier hs-var">Multipart</span></a><span>
</span><a name="line-784"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-785"></a><span>
</span><a name="line-786"></a><span class="hs-identifier">fileAFormReq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadHandler</span><span> </span><a href="#local-6989586621679193281"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RenderMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193281"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="Yesod.Form.Types.html#FormMessage"><span class="hs-identifier hs-type">FormMessage</span></a><span class="hs-special">)</span><span>
</span><a name="line-787"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#FieldSettings"><span class="hs-identifier hs-type">FieldSettings</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193281"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#AForm"><span class="hs-identifier hs-type">AForm</span></a><span> </span><a href="#local-6989586621679193281"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">FileInfo</span><span>
</span><a name="line-788"></a><a name="fileAFormReq"><a href="Yesod.Form.Fields.html#fileAFormReq"><span class="hs-identifier">fileAFormReq</span></a></a><span> </span><a name="local-6989586621679194422"><a href="#local-6989586621679194422"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#AForm"><span class="hs-identifier hs-var">AForm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679194423"><a href="#local-6989586621679194423"><span class="hs-identifier">site</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194424"><a href="#local-6989586621679194424"><span class="hs-identifier">langs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194425"><a href="#local-6989586621679194425"><span class="hs-identifier">menvs</span></a></a><span> </span><a name="local-6989586621679194426"><a href="#local-6989586621679194426"><span class="hs-identifier">ints</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-789"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194427"><a href="#local-6989586621679194427"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194428"><a href="#local-6989586621679194428"><span class="hs-identifier">ints'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-790"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fsName</span><span> </span><a href="#local-6989586621679194422"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-791"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194429"><a href="#local-6989586621679194429"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194429"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194426"><span class="hs-identifier hs-var">ints</span></a><span class="hs-special">)</span><span>
</span><a name="line-792"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-793"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194430"><a href="#local-6989586621679194430"><span class="hs-identifier">i'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#incrInts"><span class="hs-identifier hs-var">incrInts</span></a><span> </span><a href="#local-6989586621679194426"><span class="hs-identifier hs-var">ints</span></a><span>
</span><a name="line-794"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-char">'f'</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679194430"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194430"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">)</span><span>
</span><a name="line-795"></a><span>    </span><a name="local-6989586621679194431"><a href="#local-6989586621679194431"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">newIdent</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">fsId</span><span> </span><a href="#local-6989586621679194422"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-796"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194432"><a href="#local-6989586621679194432"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194433"><a href="#local-6989586621679194433"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-797"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194425"><span class="hs-identifier hs-var">menvs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-798"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormMissing"><span class="hs-identifier hs-var">FormMissing</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-799"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194434"><a href="#local-6989586621679194434"><span class="hs-identifier">fenv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-800"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679194427"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679194434"><span class="hs-identifier hs-var">fenv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-801"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194435"><a href="#local-6989586621679194435"><span class="hs-identifier">fi</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormSuccess"><span class="hs-identifier hs-var">FormSuccess</span></a><span> </span><a href="#local-6989586621679194435"><span class="hs-identifier hs-var">fi</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-802"></a><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-803"></a><span>                            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194436"><a href="#local-6989586621679194436"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">renderMessage</span><span> </span><a href="#local-6989586621679194423"><span class="hs-identifier hs-var">site</span></a><span> </span><a href="#local-6989586621679194424"><span class="hs-identifier hs-var">langs</span></a><span> </span><a href="Yesod.Form.Types.html#MsgValueRequired"><span class="hs-identifier hs-var">MsgValueRequired</span></a><span>
</span><a name="line-804"></a><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormFailure"><span class="hs-identifier hs-var">FormFailure</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679194436"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toHtml</span><span> </span><span class="hs-identifier hs-var">t</span><span class="hs-special">)</span><span>
</span><a name="line-805"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194437"><a href="#local-6989586621679194437"><span class="hs-identifier">fv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#FieldView"><span class="hs-identifier hs-var">FieldView</span></a><span>
</span><a name="line-806"></a><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fvLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toHtml</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">renderMessage</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-identifier">langs</span><span> </span><a href="#local-6989586621679194424"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">fsLabel</span><span> </span><span class="hs-identifier">fs</span><span>
</span><a name="line-807"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvTooltip</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toHtml</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">renderMessage</span><span> </span><span class="hs-identifier">site</span><span> </span><span class="hs-identifier">langs</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">fsTooltip</span><span> </span><span class="hs-identifier">fs</span><span>
</span><a name="line-808"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvId</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194431"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-809"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvInput</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="">[whamlet|
$newline never
&lt;input type=file name=#{name} ##{id'} *{fsAttrs fs}&gt;
|]</span><span>
</span><a name="line-813"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvErrors</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194433"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-814"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvRequired</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-815"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-816"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194432"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194437"><span class="hs-identifier hs-var">fv</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194428"><span class="hs-identifier hs-var">ints'</span></a><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Types.html#Multipart"><span class="hs-identifier hs-var">Multipart</span></a><span class="hs-special">)</span><span>
</span><a name="line-817"></a><span>
</span><a name="line-818"></a><span class="hs-identifier">fileAFormOpt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadHandler</span><span> </span><a href="#local-6989586621679193280"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-819"></a><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Form.Types.html#FieldSettings"><span class="hs-identifier hs-type">FieldSettings</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HandlerSite</span><span> </span><a href="#local-6989586621679193280"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span>
</span><a name="line-820"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#AForm"><span class="hs-identifier hs-type">AForm</span></a><span> </span><a href="#local-6989586621679193280"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">FileInfo</span><span class="hs-special">)</span><span>
</span><a name="line-821"></a><a name="fileAFormOpt"><a href="Yesod.Form.Fields.html#fileAFormOpt"><span class="hs-identifier">fileAFormOpt</span></a></a><span> </span><a name="local-6989586621679194442"><a href="#local-6989586621679194442"><span class="hs-identifier">fs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#AForm"><span class="hs-identifier hs-var">AForm</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679194443"><a href="#local-6989586621679194443"><span class="hs-identifier">master</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194444"><a href="#local-6989586621679194444"><span class="hs-identifier">langs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679194445"><a href="#local-6989586621679194445"><span class="hs-identifier">menvs</span></a></a><span> </span><a name="local-6989586621679194446"><a href="#local-6989586621679194446"><span class="hs-identifier">ints</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-822"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194447"><a href="#local-6989586621679194447"><span class="hs-identifier">name</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194448"><a href="#local-6989586621679194448"><span class="hs-identifier">ints'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-823"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fsName</span><span> </span><a href="#local-6989586621679194442"><span class="hs-identifier hs-var">fs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-824"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679194449"><a href="#local-6989586621679194449"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194449"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194446"><span class="hs-identifier hs-var">ints</span></a><span class="hs-special">)</span><span>
</span><a name="line-825"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-826"></a><span>                    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194450"><a href="#local-6989586621679194450"><span class="hs-identifier">i'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Fields.html#incrInts"><span class="hs-identifier hs-var">incrInts</span></a><span> </span><a href="#local-6989586621679194446"><span class="hs-identifier hs-var">ints</span></a><span>
</span><a name="line-827"></a><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-char">'f'</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679194450"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194450"><span class="hs-identifier hs-var">i'</span></a><span class="hs-special">)</span><span>
</span><a name="line-828"></a><span>    </span><a name="local-6989586621679194451"><a href="#local-6989586621679194451"><span class="hs-identifier">id'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">newIdent</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">fsId</span><span> </span><a href="#local-6989586621679194442"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-829"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194452"><a href="#local-6989586621679194452"><span class="hs-identifier">res</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679194453"><a href="#local-6989586621679194453"><span class="hs-identifier">errs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-830"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679194445"><span class="hs-identifier hs-var">menvs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-831"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormMissing"><span class="hs-identifier hs-var">FormMissing</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-832"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679194454"><a href="#local-6989586621679194454"><span class="hs-identifier">fenv</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-833"></a><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">Map.lookup</span><span> </span><a href="#local-6989586621679194447"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679194454"><span class="hs-identifier hs-var">fenv</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-834"></a><span>                        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679194455"><a href="#local-6989586621679194455"><span class="hs-identifier">fi</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormSuccess"><span class="hs-identifier hs-var">FormSuccess</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679194455"><span class="hs-identifier hs-var">fi</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-835"></a><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#FormSuccess"><span class="hs-identifier hs-var">FormSuccess</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-836"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679194456"><a href="#local-6989586621679194456"><span class="hs-identifier">fv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#FieldView"><span class="hs-identifier hs-var">FieldView</span></a><span>
</span><a name="line-837"></a><span>            </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">fvLabel</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toHtml</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">renderMessage</span><span> </span><span class="hs-identifier">master</span><span> </span><span class="hs-identifier">langs</span><span> </span><a href="#local-6989586621679194444"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">fsLabel</span><span> </span><span class="hs-identifier">fs</span><span>
</span><a name="line-838"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvTooltip</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toHtml</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">renderMessage</span><span> </span><span class="hs-identifier">master</span><span> </span><span class="hs-identifier">langs</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">fsTooltip</span><span> </span><span class="hs-identifier">fs</span><span>
</span><a name="line-839"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvId</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194451"><span class="hs-identifier hs-var">id'</span></a><span>
</span><a name="line-840"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvInput</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="">[whamlet|
$newline never
&lt;input type=file name=#{name} ##{id'} *{fsAttrs fs}&gt;
|]</span><span>
</span><a name="line-844"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvErrors</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679194453"><span class="hs-identifier hs-var">errs</span></a><span>
</span><a name="line-845"></a><span>            </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">fvRequired</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-846"></a><span>            </span><span class="hs-special">}</span><span>
</span><a name="line-847"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194452"><span class="hs-identifier hs-var">res</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194456"><span class="hs-identifier hs-var">fv</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679194448"><span class="hs-identifier hs-var">ints'</span></a><span class="hs-special">,</span><span> </span><a href="Yesod.Form.Types.html#Multipart"><span class="hs-identifier hs-var">Multipart</span></a><span class="hs-special">)</span><span>
</span><a name="line-848"></a><span>
</span><a name="line-849"></a><span class="hs-identifier">incrInts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Yesod.Form.Types.html#Ints"><span class="hs-identifier hs-type">Ints</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Yesod.Form.Types.html#Ints"><span class="hs-identifier hs-type">Ints</span></a><span>
</span><a name="line-850"></a><a name="incrInts"><a href="Yesod.Form.Fields.html#incrInts"><span class="hs-identifier">incrInts</span></a></a><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#IntSingle"><span class="hs-identifier hs-var">IntSingle</span></a><span> </span><a name="local-6989586621679194461"><a href="#local-6989586621679194461"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Form.Types.html#IntSingle"><span class="hs-identifier hs-var">IntSingle</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679194461"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-851"></a><span class="hs-identifier">incrInts</span><span> </span><span class="hs-special">(</span><a href="Yesod.Form.Types.html#IntCons"><span class="hs-identifier hs-var">IntCons</span></a><span> </span><a name="local-6989586621679194462"><a href="#local-6989586621679194462"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679194463"><a href="#local-6989586621679194463"><span class="hs-identifier">is</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679194462"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="Yesod.Form.Types.html#IntCons"><span class="hs-identifier hs-var">IntCons</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194463"><span class="hs-identifier hs-var">is</span></a><span>
</span><a name="line-852"></a><span>
</span><a name="line-853"></a><span>
</span><a name="line-854"></a><span class="hs-comment">-- | Adds a '0' to some text so that it may be recognized as a double.</span><span>
</span><a name="line-855"></a><span class="hs-comment">--   The read ftn does not recognize &quot;.3&quot; as 0.3 nor &quot;-.3&quot; as -0.3, so this</span><span>
</span><a name="line-856"></a><span class="hs-comment">--   function changes &quot;.xxx&quot; to &quot;0.xxx&quot; and &quot;-.xxx&quot; to &quot;-0.xxx&quot;</span><span>
</span><a name="line-857"></a><span>
</span><a name="line-858"></a><span class="hs-identifier">prependZero</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-859"></a><a name="prependZero"><a href="Yesod.Form.Fields.html#prependZero"><span class="hs-identifier">prependZero</span></a></a><span> </span><a name="local-6989586621679194464"><a href="#local-6989586621679194464"><span class="hs-identifier">t0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">T.null</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-860"></a><span>                 </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-861"></a><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">T.head</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'.'</span><span>
</span><a name="line-862"></a><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="hs-char">'0'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.cons</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-863"></a><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-string">&quot;-.&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-864"></a><span>                           </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;-0.&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">T.append</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">)</span><span>
</span><a name="line-865"></a><span>                           </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679194465"><span class="hs-identifier hs-var">t1</span></a><span>
</span><a name="line-866"></a><span>
</span><a name="line-867"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679194465"><a href="#local-6989586621679194465"><span class="hs-identifier">t1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span> </span><span class="hs-char">' '</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679194464"><span class="hs-identifier hs-var">t0</span></a><span>
</span><a name="line-868"></a><span>
</span><a name="line-869"></a><span class="hs-comment">-- $optionsOverview</span><span>
</span><a name="line-870"></a><span class="hs-comment">-- These functions create inputs where one or more options can be selected from a list.</span><span>
</span><a name="line-871"></a><span class="hs-comment">-- </span><span>
</span><a name="line-872"></a><span class="hs-comment">-- The basic datastructure used is an 'Option', which combines a user-facing display value, the internal Haskell value being selected, and an external 'Text' stored as the @value@ in the form (used to map back to the internal value). A list of these, together with a function mapping from an external value back to a Haskell value, form an 'OptionList', which several of these functions take as an argument.</span><span>
</span><a name="line-873"></a><span class="hs-comment">-- </span><span>
</span><a name="line-874"></a><span class="hs-comment">-- Typically, you won't need to create an 'OptionList' directly and can instead make one with functions like 'optionsPairs' or 'optionsEnum'. Alternatively, you can use functions like 'selectFieldList', which use their @[(msg, a)]@ parameter to create an 'OptionList' themselves.</span><span>
</span><a name="line-875"></a></pre></body></html>