<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Web.ClientSession</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Web.ClientSession.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">clientsession-0.9.1.2: Securely store session data in a client-side cookie.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Michael Snoyman</td></tr><tr><th>License</th><td>BSD3</td></tr><tr><th>Maintainer</th><td>Michael Snoyman &lt;michael@snoyman.com&gt;</td></tr><tr><th>Stability</th><td>Stable</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Web.ClientSession</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Automatic key generation</a></li><li><a href="#g:2">Actual encryption/decryption</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Stores session data in a client cookie.  In order to do so,
 we:</p><ul><li>Encrypt the cookie data using AES in CTR mode.  This allows
 you to store sensitive information on the client side without
 worrying about eavesdropping.</li><li>Authenticate the encrypted cookie data using
 Skein-MAC-512-256.  Besides detecting potential errors in
 storage or transmission of the cookies (integrity), the MAC
 also avoids malicious modifications of the cookie data by
 assuring you that the cookie data really was generated by this
 server (authenticity).</li><li>Encode everything using Base64.  Thus we avoid problems with
 non-printable characters by giving the browser a simple
 string.</li></ul><p>Simple usage of the library involves just calling
 <code><a href="Web-ClientSession.html#v:getDefaultKey" title="Web.ClientSession">getDefaultKey</a></code> on the startup of your server, <code><a href="Web-ClientSession.html#v:encryptIO" title="Web.ClientSession">encryptIO</a></code>
 when serializing cookies and <code><a href="Web-ClientSession.html#v:decrypt" title="Web.ClientSession">decrypt</a></code> when parsing then back.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Key">Key</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:IV">IV</a></li><li class="src short"><a href="#v:randomIV">randomIV</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></li><li class="src short"><a href="#v:mkIV">mkIV</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></li><li class="src short"><a href="#v:getKey">getKey</a> :: <a href="../base-4.12.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></li><li class="src short"><a href="#v:getKeyEnv">getKeyEnv</a> :: <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></li><li class="src short"><a href="#v:defaultKeyFile">defaultKeyFile</a> :: <a href="../base-4.12.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a></li><li class="src short"><a href="#v:getDefaultKey">getDefaultKey</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></li><li class="src short"><a href="#v:initKey">initKey</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></li><li class="src short"><a href="#v:randomKey">randomKey</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a>)</li><li class="src short"><a href="#v:randomKeyEnv">randomKeyEnv</a> :: <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></li><li class="src short"><a href="#v:encrypt">encrypt</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:encryptIO">encryptIO</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li><li class="src short"><a href="#v:decrypt">decrypt</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Automatic key generation</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Key" class="def">Key</a> <a href="src/Web.ClientSession.html#Key" class="link">Source</a> <a href="#t:Key" class="selflink">#</a></p><div class="doc"><p>The keys used to store the cookies.  We have an AES key used
 to encrypt the cookie and a Skein-MAC-512-256 key used verify
 the authencity and integrity of the cookie.  The AES key must
 have exactly 32 bytes (256 bits) while Skein-MAC-512-256 must
 have 64 bytes (512 bits).</p><p>See also <code><a href="Web-ClientSession.html#v:getDefaultKey" title="Web.ClientSession">getDefaultKey</a></code> and <code><a href="Web-ClientSession.html#v:initKey" title="Web.ClientSession">initKey</a></code>.</p></div><div class="subs instances"><details id="i:Key" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Key:Eq:1"></span> <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></span> <a href="src/Web.ClientSession.html#line-137" class="link">Source</a> <a href="#t:Key" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Key:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Key:Show:2"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></span> <a href="src/Web.ClientSession.html#line-145" class="link">Source</a> <a href="#t:Key" class="selflink">#</a></td><td class="doc"><p>Dummy <code><a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a></code> instance.</p></td></tr><tr><td colspan="2"><details id="i:id:Key:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Key:Serialize:3"></span> <a href="../cereal-0.5.8.1/Data-Serialize.html#t:Serialize" title="Data.Serialize">Serialize</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></span> <a href="src/Web.ClientSession.html#line-140" class="link">Source</a> <a href="#t:Key" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Key:Serialize:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:put">put</a> :: <a href="../cereal-0.5.8.1/Data-Serialize-Put.html#t:Putter" title="Data.Serialize.Put">Putter</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:get">get</a> :: <a href="../cereal-0.5.8.1/Data-Serialize-Get.html#t:Get" title="Data.Serialize.Get">Get</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> <a href="#v:get" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:IV" class="def">IV</a> <a href="src/Web.ClientSession.html#IV" class="link">Source</a> <a href="#t:IV" class="selflink">#</a></p><div class="doc"><p>The initialization vector used by AES.  Must be exactly 16
 bytes long.</p></div><div class="subs instances"><details id="i:IV" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IV:Eq:1"></span> <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></span> <a href="src/Web.ClientSession.html#line-158" class="link">Source</a> <a href="#t:IV" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IV:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IV:Ord:2"></span> <a href="../base-4.12.0.0/Data-Ord.html#t:Ord" title="Data.Ord">Ord</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></span> <a href="src/Web.ClientSession.html#line-162" class="link">Source</a> <a href="#t:IV" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IV:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Ord.html#t:Ordering" title="Data.Ord">Ordering</a> <a href="#v:compare" class="selflink">#</a></p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-60-" class="selflink">#</a></p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-60--61-" class="selflink">#</a></p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-62-" class="selflink">#</a></p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-62--61-" class="selflink">#</a></p><p class="src"><a href="#v:max">max</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="#v:max" class="selflink">#</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="#v:min" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IV:Show:3"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></span> <a href="src/Web.ClientSession.html#line-169" class="link">Source</a> <a href="#t:IV" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IV:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:IV:Serialize:4"></span> <a href="../cereal-0.5.8.1/Data-Serialize.html#t:Serialize" title="Data.Serialize">Serialize</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></span> <a href="src/Web.ClientSession.html#line-172" class="link">Source</a> <a href="#t:IV" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:IV:Serialize:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Web-ClientSession.html">Web.ClientSession</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:put">put</a> :: <a href="../cereal-0.5.8.1/Data-Serialize-Put.html#t:Putter" title="Data.Serialize.Put">Putter</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="#v:put" class="selflink">#</a></p><p class="src"><a href="#v:get">get</a> :: <a href="../cereal-0.5.8.1/Data-Serialize-Get.html#t:Get" title="Data.Serialize.Get">Get</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="#v:get" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:randomIV" class="def">randomIV</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="src/Web.ClientSession.html#randomIV" class="link">Source</a> <a href="#v:randomIV" class="selflink">#</a></p><div class="doc"><p>Randomly construct a fresh initialization vector.  You
 <em>MUST NOT</em> reuse initialization vectors.</p></div></div><div class="top"><p class="src"><a id="v:mkIV" class="def">mkIV</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a> <a href="src/Web.ClientSession.html#mkIV" class="link">Source</a> <a href="#v:mkIV" class="selflink">#</a></p><div class="doc"><p>Construct an initialization vector from a <code><a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code>.
 Fails if there isn't exactly 16 bytes.</p></div></div><div class="top"><p class="src"><a id="v:getKey" class="def">getKey</a> <a href="src/Web.ClientSession.html#getKey" class="link">Source</a> <a href="#v:getKey" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.12.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a></td><td class="doc"><p>File name where key is stored.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></td><td class="doc"><p>The actual key.</p></td></tr></table></div><div class="doc"><p>Get a key from the given text file.</p><p>If the file does not exist or is corrupted a random key will
 be generated and stored in that file.</p></div></div><div class="top"><p class="src"><a id="v:getKeyEnv" class="def">getKeyEnv</a> <a href="src/Web.ClientSession.html#getKeyEnv" class="link">Source</a> <a href="#v:getKeyEnv" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a></td><td class="doc"><p>Name of the environment variable</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></td><td class="doc"><p>The actual key.</p></td></tr></table></div><div class="doc"><p>Get the key from the named environment variable</p><p>Assumes the value is a Base64-encoded string. If the variable is not set, a
 random key will be generated, set in the environment, and the Base64-encoded
 version printed on <code><em>dev</em>stdout</code>.</p></div></div><div class="top"><p class="src"><a id="v:defaultKeyFile" class="def">defaultKeyFile</a> :: <a href="../base-4.12.0.0/System-IO.html#t:FilePath" title="System.IO">FilePath</a> <a href="src/Web.ClientSession.html#defaultKeyFile" class="link">Source</a> <a href="#v:defaultKeyFile" class="selflink">#</a></p><div class="doc"><p>The default key file.</p></div></div><div class="top"><p class="src"><a id="v:getDefaultKey" class="def">getDefaultKey</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> <a href="src/Web.ClientSession.html#getDefaultKey" class="link">Source</a> <a href="#v:getDefaultKey" class="selflink">#</a></p><div class="doc"><p>Simply calls <code><a href="Web-ClientSession.html#v:getKey" title="Web.ClientSession">getKey</a></code> <code><a href="Web-ClientSession.html#v:defaultKeyFile" title="Web.ClientSession">defaultKeyFile</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:initKey" class="def">initKey</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> <a href="src/Web.ClientSession.html#initKey" class="link">Source</a> <a href="#v:initKey" class="selflink">#</a></p><div class="doc"><p>Initializes a <code><a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></code> from a random <code><a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></code>.  Fails if
 there isn't exactly 96 bytes (256 bits for AES and 512 bits
 for Skein-MAC-512-512).</p><p>Note that the input string is assumed to be uniformly chosen
 from the set of all 96-byte strings.  In other words, each
 byte should be chosen from the set of all byte values (0-255)
 with the same probability.</p><p>In particular, this function does not do any kind of key
 stretching.  You should never feed it a password, for example.</p><p>It's <em>highly</em> recommended to feed <code>initKey</code> only with values
 generated by <code><a href="Web-ClientSession.html#v:randomKey" title="Web.ClientSession">randomKey</a></code>, unless you really know what you're
 doing.</p></div></div><div class="top"><p class="src"><a id="v:randomKey" class="def">randomKey</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a>) <a href="src/Web.ClientSession.html#randomKey" class="link">Source</a> <a href="#v:randomKey" class="selflink">#</a></p><div class="doc"><p>Generate a random <code><a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></code>.  Besides the <code><a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></code>, the
 <code>ByteString</code> passed to <code><a href="Web-ClientSession.html#v:initKey" title="Web.ClientSession">initKey</a></code> is returned so that it can be
 saved for later use.</p></div></div><div class="top"><p class="src"><a id="v:randomKeyEnv" class="def">randomKeyEnv</a> :: <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> <a href="src/Web.ClientSession.html#randomKeyEnv" class="link">Source</a> <a href="#v:randomKeyEnv" class="selflink">#</a></p><div class="doc"><p>Generate a random <code><a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></code>, set a Base64-encoded version of it in the given
 environment variable, then return it. Also prints the generated string to
 <code><em>dev</em>stdout</code>.</p></div></div><a href="#g:2" id="g:2"><h1>Actual encryption/decryption</h1></a><div class="top"><p class="src"><a id="v:encrypt" class="def">encrypt</a> <a href="src/Web.ClientSession.html#encrypt" class="link">Source</a> <a href="#v:encrypt" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></td><td class="doc"><p>Key of the server.</p></td></tr><tr><td class="src">-&gt; <a href="Web-ClientSession.html#t:IV" title="Web.ClientSession">IV</a></td><td class="doc"><p>New, random initialization vector (see <code><a href="Web-ClientSession.html#v:randomIV" title="Web.ClientSession">randomIV</a></code>).</p></td></tr><tr><td class="src">-&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Serialized cookie data.</p></td></tr><tr><td class="src">-&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Encoded cookie data to be given to
 the client browser.</p></td></tr></table></div><div class="doc"><p>Encrypt (AES-CTR), authenticate (Skein-MAC-512-256) and
 encode (Base64) the given cookie data.  The returned byte
 string is ready to be used in a response header.</p></div></div><div class="top"><p class="src"><a id="v:encryptIO" class="def">encryptIO</a> :: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a> -&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Web.ClientSession.html#encryptIO" class="link">Source</a> <a href="#v:encryptIO" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="Web-ClientSession.html#v:encrypt" title="Web.ClientSession">encrypt</a></code>, however randomly generates the
 initialization vector for you.</p></div></div><div class="top"><p class="src"><a id="v:decrypt" class="def">decrypt</a> <a href="src/Web.ClientSession.html#decrypt" class="link">Source</a> <a href="#v:decrypt" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Web-ClientSession.html#t:Key" title="Web.ClientSession">Key</a></td><td class="doc"><p>Key of the server.</p></td></tr><tr><td class="src">-&gt; <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Encoded cookie data given by the browser.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.12.0.0/GHC-Maybe.html#t:Maybe" title="GHC.Maybe">Maybe</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></td><td class="doc"><p>Serialized cookie data.</p></td></tr></table></div><div class="doc"><p>Decode (Base64), verify the integrity and authenticity
 (Skein-MAC-512-256) and decrypt (AES-CTR) the given encoded
 cookie data.  Returns the original serialized cookie data.
 Fails if the data is corrupted.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>