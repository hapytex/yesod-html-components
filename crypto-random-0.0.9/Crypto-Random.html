<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Crypto.Random</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Crypto.Random.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">crypto-random-0.0.9: Simple cryptographic random related types</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>License</th><td>BSD-style</td></tr><tr><th>Maintainer</th><td>Vincent Hanquez &lt;vincent@snarc.org&gt;</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>Good</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Crypto.Random</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Entropy</a></li><li><a href="#g:2">Random generation</a></li><li><a href="#g:3">System generator</a></li><li><a href="#g:4">Testing and mocking</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Provide a safe abstraction for cryptographic pseudo
 random generator.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:EntropyPool">EntropyPool</a></li><li class="src short"><a href="#v:createEntropyPool">createEntropyPool</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a></li><li class="src short"><a href="#v:grabEntropy">grabEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="../securemem-0.1.10/Data-SecureMem.html#t:SecureMem" title="Data.SecureMem">SecureMem</a></li><li class="src short"><a href="#v:grabEntropyIO">grabEntropyIO</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../securemem-0.1.10/Data-SecureMem.html#t:SecureMem" title="Data.SecureMem">SecureMem</a></li><li class="src short"><span class="keyword">class</span> <a href="#t:CPRG">CPRG</a> gen <span class="keyword">where</span><ul class="subs"><li><a href="#v:cprgCreate">cprgCreate</a> :: <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; gen</li><li><a href="#v:cprgSetReseedThreshold">cprgSetReseedThreshold</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; gen</li><li><a href="#v:cprgFork">cprgFork</a> :: gen -&gt; (gen, gen)</li><li><a href="#v:cprgGenerate">cprgGenerate</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, gen)</li><li><a href="#v:cprgGenerateWithEntropy">cprgGenerateWithEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, gen)</li></ul></li><li class="src short"><a href="#v:withRandomBytes">withRandomBytes</a> :: <a href="Crypto-Random.html#t:CPRG" title="Crypto.Random">CPRG</a> g =&gt; g -&gt; <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; a) -&gt; (a, g)</li><li class="src short"><span class="keyword">data</span> <a href="#t:SystemRNG">SystemRNG</a></li><li class="src short"><a href="#v:createTestEntropyPool">createTestEntropyPool</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Entropy</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EntropyPool" class="def">EntropyPool</a> <a href="src/Crypto.Random.Entropy.html#EntropyPool" class="link">Source</a> <a href="#t:EntropyPool" class="selflink">#</a></p><div class="doc"><p>Pool of Entropy. contains a self mutating pool of entropy,
 that is always guarantee to contains data.</p></div></div><div class="top"><p class="src"><a id="v:createEntropyPool" class="def">createEntropyPool</a> :: <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> <a href="src/Crypto.Random.Entropy.html#createEntropyPool" class="link">Source</a> <a href="#v:createEntropyPool" class="selflink">#</a></p><div class="doc"><p>Create a new entropy pool with a default size.</p><p>While you can create as many entropy pool as you want, the pool can be shared between multiples RNGs.</p></div></div><div class="top"><p class="src"><a id="v:grabEntropy" class="def">grabEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="../securemem-0.1.10/Data-SecureMem.html#t:SecureMem" title="Data.SecureMem">SecureMem</a> <a href="src/Crypto.Random.Entropy.html#grabEntropy" class="link">Source</a> <a href="#v:grabEntropy" class="selflink">#</a></p><div class="doc"><p>Grab a chunk of entropy from the entropy pool.</p><p>Great care need to be taken here when using the output,
 as this use unsafePerformIO to actually get entropy.</p><p>Use grabEntropyIO if unsure.</p></div></div><div class="top"><p class="src"><a id="v:grabEntropyIO" class="def">grabEntropyIO</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="../base-4.12.0.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../securemem-0.1.10/Data-SecureMem.html#t:SecureMem" title="Data.SecureMem">SecureMem</a> <a href="src/Crypto.Random.Entropy.html#grabEntropyIO" class="link">Source</a> <a href="#v:grabEntropyIO" class="selflink">#</a></p><div class="doc"><p>Grab a chunk of entropy from the entropy pool.</p></div></div><a href="#g:2" id="g:2"><h1>Random generation</h1></a><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:CPRG" class="def">CPRG</a> gen <span class="keyword">where</span> <a href="src/Crypto.Random.Generator.html#CPRG" class="link">Source</a> <a href="#t:CPRG" class="selflink">#</a></p><div class="doc"><p>Cryptographic Pseudo Random Generator</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:cprgCreate" class="def">cprgCreate</a> :: <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; gen <a href="src/Crypto.Random.Generator.html#cprgCreate" class="link">Source</a> <a href="#v:cprgCreate" class="selflink">#</a></p><div class="doc"><p>Create a new CPRG using an object of the CryptoGenerator class
 and with an explicit reference to an EntropyPool.</p></div><p class="src"><a id="v:cprgSetReseedThreshold" class="def">cprgSetReseedThreshold</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; gen <a href="src/Crypto.Random.Generator.html#cprgSetReseedThreshold" class="link">Source</a> <a href="#v:cprgSetReseedThreshold" class="selflink">#</a></p><div class="doc"><p>Give the ability to set a threshold of byte generated that after
 being exceeded will result in a reseed with some stateful entropy
 after a call to <code><a href="Crypto-Random.html#v:cprgGenerate" title="Crypto.Random">cprgGenerate</a></code></p><p>If this threshold is exceeded during the set operation, the
 rng should be reseeded here.</p><p>If this value is set to 0, no reseeding will be done and the
 output will be completely predicable. This is not a recommended
 level except for debugging and testing purpose.</p></div><p class="src"><a id="v:cprgFork" class="def">cprgFork</a> :: gen -&gt; (gen, gen) <a href="src/Crypto.Random.Generator.html#cprgFork" class="link">Source</a> <a href="#v:cprgFork" class="selflink">#</a></p><div class="doc"><p>Fork a CPRG into a new independent CPRG.</p><p>As entropy is mixed to generate safely a new generator,
 2 calls with the same CPRG will not produce the same output.</p></div><p class="src"><a id="v:cprgGenerate" class="def">cprgGenerate</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, gen) <a href="src/Crypto.Random.Generator.html#cprgGenerate" class="link">Source</a> <a href="#v:cprgGenerate" class="selflink">#</a></p><div class="doc"><p>Generate a number of bytes using the CPRG.</p><p>Given one CPRG, the generated bytes will always be the same.</p><p>However the returned CPRG might have been reseeded with entropy bits,
 so 2 calls with the same CPRG will not necessarily result in the same next CPRG.</p></div><p class="src"><a id="v:cprgGenerateWithEntropy" class="def">cprgGenerateWithEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; gen -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, gen) <a href="src/Crypto.Random.Generator.html#cprgGenerateWithEntropy" class="link">Source</a> <a href="#v:cprgGenerateWithEntropy" class="selflink">#</a></p><div class="doc"><p>Similar to cprgGenerate except that the random data is mixed with pure entropy,
 so the result is not reproducible after use, but it provides more guarantee,
 theorically speaking, in term of the randomness generated.</p></div></div><div class="subs instances"><details id="i:CPRG" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:CPRG:CPRG:1"></span> <a href="Crypto-Random.html#t:CPRG" title="Crypto.Random">CPRG</a> <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a></span> <a href="src/Crypto.Random.html#line-46" class="link">Source</a> <a href="#t:CPRG" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:CPRG:CPRG:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Random.html">Crypto.Random</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cprgCreate">cprgCreate</a> :: <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> <a href="src/Crypto.Random.Generator.html#cprgCreate" class="link">Source</a> <a href="#v:cprgCreate" class="selflink">#</a></p><p class="src"><a href="#v:cprgSetReseedThreshold">cprgSetReseedThreshold</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> <a href="src/Crypto.Random.Generator.html#cprgSetReseedThreshold" class="link">Source</a> <a href="#v:cprgSetReseedThreshold" class="selflink">#</a></p><p class="src"><a href="#v:cprgFork">cprgFork</a> :: <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgFork" class="link">Source</a> <a href="#v:cprgFork" class="selflink">#</a></p><p class="src"><a href="#v:cprgGenerate">cprgGenerate</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgGenerate" class="link">Source</a> <a href="#v:cprgGenerate" class="selflink">#</a></p><p class="src"><a href="#v:cprgGenerateWithEntropy">cprgGenerateWithEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgGenerateWithEntropy" class="link">Source</a> <a href="#v:cprgGenerateWithEntropy" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:withRandomBytes" class="def">withRandomBytes</a> :: <a href="Crypto-Random.html#t:CPRG" title="Crypto.Random">CPRG</a> g =&gt; g -&gt; <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; a) -&gt; (a, g) <a href="src/Crypto.Random.html#withRandomBytes" class="link">Source</a> <a href="#v:withRandomBytes" class="selflink">#</a></p><div class="doc"><p>generate <code>len random bytes and mapped the bytes to the function </code>f.</p><p>This is equivalent to use Control.Arrow <code>first</code> with <code><a href="Crypto-Random.html#v:cprgGenerate" title="Crypto.Random">cprgGenerate</a></code></p></div></div><a href="#g:3" id="g:3"><h1>System generator</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SystemRNG" class="def">SystemRNG</a> <a href="src/Crypto.Random.html#SystemRNG" class="link">Source</a> <a href="#t:SystemRNG" class="selflink">#</a></p><div class="doc"><p>System entropy generator.</p><p>This generator doesn't use the entropy reseed level, as the only bytes
 generated are comping from the entropy pool already.</p><p>This generator doesn't create reproducible output, and might be difficult to
 use for testing and debugging purpose, but otherwise for real world use case
 should be fine.</p></div><div class="subs instances"><details id="i:SystemRNG" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SystemRNG:CPRG:1"></span> <a href="Crypto-Random.html#t:CPRG" title="Crypto.Random">CPRG</a> <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a></span> <a href="src/Crypto.Random.html#line-46" class="link">Source</a> <a href="#t:SystemRNG" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SystemRNG:CPRG:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Crypto-Random.html">Crypto.Random</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:cprgCreate">cprgCreate</a> :: <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> <a href="src/Crypto.Random.Generator.html#cprgCreate" class="link">Source</a> <a href="#v:cprgCreate" class="selflink">#</a></p><p class="src"><a href="#v:cprgSetReseedThreshold">cprgSetReseedThreshold</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> <a href="src/Crypto.Random.Generator.html#cprgSetReseedThreshold" class="link">Source</a> <a href="#v:cprgSetReseedThreshold" class="selflink">#</a></p><p class="src"><a href="#v:cprgFork">cprgFork</a> :: <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgFork" class="link">Source</a> <a href="#v:cprgFork" class="selflink">#</a></p><p class="src"><a href="#v:cprgGenerate">cprgGenerate</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgGenerate" class="link">Source</a> <a href="#v:cprgGenerate" class="selflink">#</a></p><p class="src"><a href="#v:cprgGenerateWithEntropy">cprgGenerateWithEntropy</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a> -&gt; (<a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a>, <a href="Crypto-Random.html#t:SystemRNG" title="Crypto.Random">SystemRNG</a>) <a href="src/Crypto.Random.Generator.html#cprgGenerateWithEntropy" class="link">Source</a> <a href="#v:cprgGenerateWithEntropy" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:4" id="g:4"><h1>Testing and mocking</h1></a><div class="top"><p class="src"><a id="v:createTestEntropyPool" class="def">createTestEntropyPool</a> :: <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> -&gt; <a href="Crypto-Random.html#t:EntropyPool" title="Crypto.Random">EntropyPool</a> <a href="src/Crypto.Random.Entropy.html#createTestEntropyPool" class="link">Source</a> <a href="#v:createTestEntropyPool" class="selflink">#</a></p><div class="doc"><p>Create a dummy entropy pool that is deterministic, and
 dependant on the input bytestring only.</p><p>This is stricly reserved for testing purpose when a deterministic seed need
 to be generated with deterministic RNGs.</p><p>Do not use in production code.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>