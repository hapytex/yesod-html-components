<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
    /NOTE/: This module is preliminary and may change at a future date.

    This module is intended to help converting a list of tags into a
    tree of tags.
-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.HTML.TagSoup.Tree</span><span>
</span><a name="line-9"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-10"></a><span>    </span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#parseTree"><span class="hs-identifier hs-var">parseTree</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#parseTreeOptions"><span class="hs-identifier hs-var">parseTreeOptions</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-11"></a><span>    </span><a href="Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#renderTree"><span class="hs-identifier hs-var">renderTree</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#renderTreeOptions"><span class="hs-identifier hs-var">renderTreeOptions</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier hs-var">transformTree</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier hs-var">universeTree</span></a><span>
</span><a name="line-12"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><a href="Text.HTML.TagSoup.html"><span class="hs-identifier">Text.HTML.TagSoup</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Parser.html#parseTags"><span class="hs-identifier hs-var">parseTags</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Parser.html#parseTagsOptions"><span class="hs-identifier hs-var">parseTagsOptions</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Render.html#renderTags"><span class="hs-identifier hs-var">renderTags</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Render.html#renderTagsOptions"><span class="hs-identifier hs-var">renderTagsOptions</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Text.HTML.TagSoup.Type.html"><span class="hs-identifier">Text.HTML.TagSoup.Type</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Arrow</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-comment">-- | A tree of 'Tag' values.</span><span>
</span><a name="line-21"></a><span class="hs-keyword">data</span><span> </span><a name="TagTree"><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier">TagTree</span></a></a><span> </span><a name="local-6989586621679068021"><a href="#local-6989586621679068021"><span class="hs-identifier">str</span></a></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | A 'TagOpen'/'TagClose' pair with the 'Tag' values in between.</span><span>
</span><a name="line-23"></a><span>      </span><a name="TagBranch"><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier">TagBranch</span></a></a><span> </span><a href="#local-6989586621679068021"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a><span> </span><a href="#local-6989586621679068021"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068021"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Any leaf node</span><span>
</span><a name="line-25"></a><span>      </span><a name="TagLeaf"><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier">TagLeaf</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068021"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Show</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679068022"><a href="#local-6989586621679068022"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a name="local-6989586621679068023"><a href="#local-6989586621679068023"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679068024"><a href="#local-6989586621679068024"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679068025"><a href="#local-6989586621679068025"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679068022"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068023"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679068022"><span class="hs-identifier hs-var">f</span></a><span class="hs-operator hs-var">***</span><a href="#local-6989586621679068022"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068024"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679068022"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679068025"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-identifier">fmap</span><span> </span><a name="local-6989586621679068026"><a href="#local-6989586621679068026"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a name="local-6989586621679068027"><a href="#local-6989586621679068027"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679068026"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068027"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- | Convert a list of tags into a tree. This version is not lazy at</span><span>
</span><a name="line-34"></a><span class="hs-comment">--   all, that is saved for version 2.</span><span>
</span><a name="line-35"></a><span class="hs-identifier">tagTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679068037"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068037"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068037"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-36"></a><a name="tagTree"><a href="Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier">tagTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068038"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>        </span><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679068040"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068040"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068040"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-39"></a><span>        </span><a name="local-6989586621679068038"><a href="#local-6989586621679068038"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-40"></a><span>        </span><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679068042"><a href="#local-6989586621679068042"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068043"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679068044"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679068038"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679068044"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679068043"><a href="#local-6989586621679068043"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679068044"><a href="#local-6989586621679068044"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068042"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>        </span><span class="hs-comment">-- the second tuple is either null or starts with a close</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679068041"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068041"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068041"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068041"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>        </span><a name="local-6989586621679068039"><a href="#local-6989586621679068039"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a name="local-6989586621679068045"><a href="#local-6989586621679068045"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679068046"><a href="#local-6989586621679068046"><span class="hs-identifier">atts</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068047"><a href="#local-6989586621679068047"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679068039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068047"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-47"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679068048"><a href="#local-6989586621679068048"><span class="hs-identifier">inner</span></a></a><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="#local-6989586621679068045"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679068046"><span class="hs-identifier hs-var">atts</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679068048"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679068049"><a href="#local-6989586621679068049"><span class="hs-identifier">inner</span></a></a><span class="hs-special">,</span><a href="Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a name="local-6989586621679068050"><a href="#local-6989586621679068050"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068051"><a href="#local-6989586621679068051"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679068050"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679068045"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679068052"><a href="#local-6989586621679068052"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679068053"><a href="#local-6989586621679068053"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068051"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="#local-6989586621679068045"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679068046"><span class="hs-identifier hs-var">atts</span></a><span> </span><a href="#local-6989586621679068049"><span class="hs-identifier hs-var">inner</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679068052"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679068053"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="#local-6989586621679068045"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679068046"><span class="hs-identifier hs-var">atts</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a href="#local-6989586621679068049"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="#local-6989586621679068050"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679068051"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;TagSoup.Tree.tagTree: safe as - forall x . isTagClose (snd (f x))&quot;</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a name="local-6989586621679068054"><a href="#local-6989586621679068054"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068055"><a href="#local-6989586621679068055"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="#local-6989586621679068054"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679068055"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679068056"><a href="#local-6989586621679068056"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068057"><a href="#local-6989586621679068057"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a href="#local-6989586621679068056"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679068058"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679068059"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679068058"><a href="#local-6989586621679068058"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679068059"><a href="#local-6989586621679068059"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068039"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679068057"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-56"></a><span>        </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">-- | Build a 'TagTree' from a string.</span><span>
</span><a name="line-59"></a><span class="hs-identifier">parseTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="#local-6989586621679068036"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679068036"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068036"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-60"></a><a name="parseTree"><a href="Text.HTML.TagSoup.Tree.html#parseTree"><span class="hs-identifier">parseTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.HTML.TagSoup.Parser.html#parseTags"><span class="hs-identifier hs-var">parseTags</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | Build a 'TagTree' from a string, specifying the 'ParseOptions'.</span><span>
</span><a name="line-63"></a><span class="hs-identifier">parseTreeOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="#local-6989586621679068035"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.HTML.TagSoup.Options.html#ParseOptions"><span class="hs-identifier hs-type">ParseOptions</span></a><span> </span><a href="#local-6989586621679068035"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068035"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068035"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-64"></a><a name="parseTreeOptions"><a href="Text.HTML.TagSoup.Tree.html#parseTreeOptions"><span class="hs-identifier">parseTreeOptions</span></a></a><span> </span><a name="local-6989586621679068060"><a href="#local-6989586621679068060"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679068061"><a href="#local-6989586621679068061"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#tagTree"><span class="hs-identifier hs-var">tagTree</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.HTML.TagSoup.Parser.html#parseTagsOptions"><span class="hs-identifier hs-var">parseTagsOptions</span></a><span> </span><a href="#local-6989586621679068060"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679068061"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-comment">-- | Flatten a 'TagTree' back to a list of 'Tag'.</span><span>
</span><a name="line-67"></a><span class="hs-identifier">flattenTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068034"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068034"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-68"></a><a name="flattenTree"><a href="Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier">flattenTree</span></a></a><span> </span><a name="local-6989586621679068062"><a href="#local-6989586621679068062"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#flattenTreeFB"><span class="hs-identifier hs-var">flattenTreeFB</span></a><span> </span><a href="#local-6989586621679068062"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-identifier">flattenTreeFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068032"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#Tag"><span class="hs-identifier hs-type">Tag</span></a><span> </span><a href="#local-6989586621679068032"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068033"><span class="hs-identifier hs-type">lst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068033"><span class="hs-identifier hs-type">lst</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068033"><span class="hs-identifier hs-type">lst</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068033"><span class="hs-identifier hs-type">lst</span></a><span>
</span><a name="line-71"></a><a name="flattenTreeFB"><a href="Text.HTML.TagSoup.Tree.html#flattenTreeFB"><span class="hs-identifier">flattenTreeFB</span></a></a><span> </span><a name="local-6989586621679068063"><a href="#local-6989586621679068063"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679068064"><a href="#local-6989586621679068064"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679068065"><a href="#local-6989586621679068065"><span class="hs-identifier">nil</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068066"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="#local-6989586621679068063"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679068065"><span class="hs-identifier hs-var">nil</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>        </span><a name="local-6989586621679068066"><a href="#local-6989586621679068066"><span class="hs-identifier">flattenTreeOnto</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679068067"><a href="#local-6989586621679068067"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068067"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-74"></a><span>        </span><span class="hs-identifier">flattenTreeOnto</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a name="local-6989586621679068068"><a href="#local-6989586621679068068"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679068069"><a href="#local-6989586621679068069"><span class="hs-identifier">atts</span></a></a><span> </span><a name="local-6989586621679068070"><a href="#local-6989586621679068070"><span class="hs-identifier">inner</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068071"><a href="#local-6989586621679068071"><span class="hs-identifier">trs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679068072"><a href="#local-6989586621679068072"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-75"></a><span>            </span><a href="Text.HTML.TagSoup.Type.html#TagOpen"><span class="hs-identifier hs-var">TagOpen</span></a><span> </span><a href="#local-6989586621679068068"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679068069"><span class="hs-identifier hs-var">atts</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679068064"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679068066"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="#local-6989586621679068070"><span class="hs-identifier hs-var">inner</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Type.html#TagClose"><span class="hs-identifier hs-var">TagClose</span></a><span> </span><a href="#local-6989586621679068068"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679068064"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679068066"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="#local-6989586621679068071"><span class="hs-identifier hs-var">trs</span></a><span> </span><a href="#local-6989586621679068072"><span class="hs-identifier hs-var">tags</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>        </span><span class="hs-identifier">flattenTreeOnto</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagLeaf"><span class="hs-identifier hs-var">TagLeaf</span></a><span> </span><a name="local-6989586621679068073"><a href="#local-6989586621679068073"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679068074"><a href="#local-6989586621679068074"><span class="hs-identifier">trs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679068075"><a href="#local-6989586621679068075"><span class="hs-identifier">tags</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068073"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679068064"><span class="hs-identifier hs-var">cons</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679068066"><span class="hs-identifier hs-var">flattenTreeOnto</span></a><span> </span><a href="#local-6989586621679068074"><span class="hs-identifier hs-var">trs</span></a><span> </span><a href="#local-6989586621679068075"><span class="hs-identifier hs-var">tags</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- | Render a 'TagTree'.</span><span>
</span><a name="line-79"></a><span class="hs-identifier">renderTree</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="#local-6989586621679068031"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068031"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068031"><span class="hs-identifier hs-type">str</span></a><span>
</span><a name="line-80"></a><a name="renderTree"><a href="Text.HTML.TagSoup.Tree.html#renderTree"><span class="hs-identifier">renderTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Render.html#renderTags"><span class="hs-identifier hs-var">renderTags</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Render a 'TagTree' with some 'RenderOptions'.</span><span>
</span><a name="line-83"></a><span class="hs-identifier">renderTreeOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.StringLike.html#StringLike"><span class="hs-identifier hs-type">StringLike</span></a><span> </span><a href="#local-6989586621679068030"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Text.HTML.TagSoup.Render.html#RenderOptions"><span class="hs-identifier hs-type">RenderOptions</span></a><span> </span><a href="#local-6989586621679068030"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068030"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679068030"><span class="hs-identifier hs-type">str</span></a><span>
</span><a name="line-84"></a><a name="renderTreeOptions"><a href="Text.HTML.TagSoup.Tree.html#renderTreeOptions"><span class="hs-identifier">renderTreeOptions</span></a></a><span> </span><a name="local-6989586621679068076"><a href="#local-6989586621679068076"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679068077"><a href="#local-6989586621679068077"><span class="hs-identifier">trees</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.HTML.TagSoup.Render.html#renderTagsOptions"><span class="hs-identifier hs-var">renderTagsOptions</span></a><span> </span><a href="#local-6989586621679068076"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#flattenTree"><span class="hs-identifier hs-var">flattenTree</span></a><span> </span><a href="#local-6989586621679068077"><span class="hs-identifier hs-var">trees</span></a><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | This operation is based on the Uniplate @universe@ function. Given a</span><span>
</span><a name="line-87"></a><span class="hs-comment">--   list of trees, it returns those trees, and all the children trees at</span><span>
</span><a name="line-88"></a><span class="hs-comment">--   any level. For example:</span><span>
</span><a name="line-89"></a><span class="hs-comment">--</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- &gt; universeTree</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- &gt;    [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span><span>
</span><a name="line-92"></a><span class="hs-comment">-- &gt; == [TagBranch &quot;a&quot; [(&quot;href&quot;,&quot;url&quot;)] [TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]]</span><span>
</span><a name="line-93"></a><span class="hs-comment">-- &gt;    ,TagBranch &quot;b&quot; [] [TagLeaf (TagText &quot;text&quot;)]]</span><span>
</span><a name="line-94"></a><span class="hs-comment">--</span><span>
</span><a name="line-95"></a><span class="hs-comment">--   This operation is particularly useful for queries. To collect all @\&quot;a\&quot;@</span><span>
</span><a name="line-96"></a><span class="hs-comment">--   tags in a tree, simply do:</span><span>
</span><a name="line-97"></a><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span class="hs-comment">-- &gt; [x | x@(TagBranch &quot;a&quot; _ _) &lt;- universeTree tree]</span><span>
</span><a name="line-99"></a><span class="hs-identifier">universeTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068029"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068029"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-100"></a><a name="universeTree"><a href="Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier">universeTree</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679068078"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-102"></a><span>        </span><a name="local-6989586621679068078"><a href="#local-6989586621679068078"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679068079"><a href="#local-6989586621679068079"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679068080"><a href="#local-6989586621679068080"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068079"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#universeTree"><span class="hs-identifier hs-var">universeTree</span></a><span> </span><a href="#local-6989586621679068080"><span class="hs-identifier hs-var">inner</span></a><span>
</span><a name="line-103"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679068081"><a href="#local-6989586621679068081"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679068081"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | This operation is based on the Uniplate @transform@ function. Given a</span><span>
</span><a name="line-107"></a><span class="hs-comment">--   list of trees, it applies the function to every tree in a bottom-up</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   manner. This operation is useful for manipulating a tree - for example</span><span>
</span><a name="line-109"></a><span class="hs-comment">--   to make all tag names upper case:</span><span>
</span><a name="line-110"></a><span class="hs-comment">--</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- &gt; upperCase = transformTree f</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- &gt;   where f (TagBranch name atts inner) = [TagBranch (map toUpper name) atts inner]</span><span>
</span><a name="line-113"></a><span class="hs-comment">-- &gt;         f x = [x]</span><span>
</span><a name="line-114"></a><span class="hs-identifier">transformTree</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068028"><span class="hs-identifier hs-type">str</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068028"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068028"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Text.HTML.TagSoup.Tree.html#TagTree"><span class="hs-identifier hs-type">TagTree</span></a><span> </span><a href="#local-6989586621679068028"><span class="hs-identifier hs-type">str</span></a><span class="hs-special">]</span><span>
</span><a name="line-115"></a><a name="transformTree"><a href="Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier">transformTree</span></a></a><span> </span><a name="local-6989586621679068082"><a href="#local-6989586621679068082"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679068083"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>        </span><a name="local-6989586621679068083"><a href="#local-6989586621679068083"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a name="local-6989586621679068084"><a href="#local-6989586621679068084"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679068085"><a href="#local-6989586621679068085"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679068086"><a href="#local-6989586621679068086"><span class="hs-identifier">inner</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068082"><span class="hs-identifier hs-var">act</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.HTML.TagSoup.Tree.html#TagBranch"><span class="hs-identifier hs-var">TagBranch</span></a><span> </span><a href="#local-6989586621679068084"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679068085"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="Text.HTML.TagSoup.Tree.html#transformTree"><span class="hs-identifier hs-var">transformTree</span></a><span> </span><a href="#local-6989586621679068082"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-6989586621679068086"><span class="hs-identifier hs-var">inner</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>        </span><span class="hs-identifier">f</span><span> </span><a name="local-6989586621679068087"><a href="#local-6989586621679068087"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679068082"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-6989586621679068087"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-119"></a></pre></body></html>