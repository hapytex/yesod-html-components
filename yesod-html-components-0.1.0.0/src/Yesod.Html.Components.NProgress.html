<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings, PatternSynonyms, QuasiQuotes #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Yesod.Html.Components.NProgress</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Css.Selector</span><span class="hs-special">(</span><span class="hs-identifier hs-type">SelectorGroup</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">csssel</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Css.Easing</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Easing</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="hs-identifier hs-var">Ease</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Aeson</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ToJSON</span><span class="hs-special">(</span><span class="hs-identifier hs-var">toJSON</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">object</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.=</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Default</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Default</span><span class="hs-special">(</span><span class="hs-identifier hs-var">def</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Text</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Text</span><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text.Julius</span><span class="hs-special">(</span><span class="hs-identifier hs-type">JavascriptUrl</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ToJavascript</span><span class="hs-special">(</span><span class="hs-identifier hs-var">toJavascript</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod.Core</span><span class="hs-special">(</span><span class="hs-identifier hs-type">MonadWidget</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">hamlet</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">julius</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Yesod.Core.Widget</span><span class="hs-special">(</span><span class="hs-identifier hs-var">addStylesheetRemote</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toWidgetBody</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">toWidgetHead</span><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-identifier">jsFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-18"></a><a name="jsFile"><a href="Yesod.Html.Components.NProgress.html#jsFile"><span class="hs-identifier">jsFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;https://unpkg.com/nprogress@0.2.0/nprogress.js&quot;</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-identifier">cssFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Text</span><span>
</span><a name="line-21"></a><a name="cssFile"><a href="Yesod.Html.Components.NProgress.html#cssFile"><span class="hs-identifier">cssFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;https://unpkg.com/nprogress@0.2.0/nprogress.css&quot;</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-identifier">cssFileInclude</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadWidget</span><span> </span><a href="#local-6989586621679087584"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679087584"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><a name="cssFileInclude"><a href="Yesod.Html.Components.NProgress.html#cssFileInclude"><span class="hs-identifier">cssFileInclude</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">addStylesheetRemote</span><span> </span><a href="Yesod.Html.Components.NProgress.html#cssFile"><span class="hs-identifier hs-var">cssFile</span></a><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-identifier">jsFileInclude</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadWidget</span><span> </span><a href="#local-6989586621679087583"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679087583"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><a name="jsFileInclude"><a href="Yesod.Html.Components.NProgress.html#jsFileInclude"><span class="hs-identifier">jsFileInclude</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toWidgetHead</span><span> </span><span class="">[hamlet|&lt;script language=javascript src=#{jsFile}&gt;|]</span><span>
</span><a name="line-28"></a><span>
</span><a name="line-29"></a><span class="hs-identifier">startDoneProgress</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">JavascriptUrl</span><span> </span><a href="#local-6989586621679087582"><span class="hs-identifier hs-type">url</span></a><span>
</span><a name="line-30"></a><a name="startDoneProgress"><a href="Yesod.Html.Components.NProgress.html#startDoneProgress"><span class="hs-identifier">startDoneProgress</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="">[julius|NProgress.start();NProgress.done();|]</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-identifier">configureProgress</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-type">NProgressConfig</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">JavascriptUrl</span><span> </span><a href="#local-6989586621679087581"><span class="hs-identifier hs-type">url</span></a><span>
</span><a name="line-33"></a><a name="configureProgress"><a href="Yesod.Html.Components.NProgress.html#configureProgress"><span class="hs-identifier">configureProgress</span></a></a><span> </span><a name="local-6989586621679088182"><a href="#local-6989586621679088182"><span class="hs-identifier">npc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="">[julius|NProgress.configure(#{npc});|]</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">data</span><span> </span><a name="NProgressConfig"><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier">NProgressConfig</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="NProgressConfig"><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier">NProgressConfig</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="minimum"><a href="Yesod.Html.Components.NProgress.html#minimum"><span class="hs-identifier">minimum</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Float</span><span class="hs-special">,</span><span> </span><a name="easing"><a href="Yesod.Html.Components.NProgress.html#easing"><span class="hs-identifier">easing</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Easing</span><span class="hs-special">,</span><span> </span><a name="speed"><a href="Yesod.Html.Components.NProgress.html#speed"><span class="hs-identifier">speed</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="trickle"><a href="Yesod.Html.Components.NProgress.html#trickle"><span class="hs-identifier">trickle</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a name="trickleSpeed"><a href="Yesod.Html.Components.NProgress.html#trickleSpeed"><span class="hs-identifier">trickleSpeed</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a name="showSpinner"><a href="Yesod.Html.Components.NProgress.html#showSpinner"><span class="hs-identifier">showSpinner</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">,</span><span> </span><a name="parent"><a href="Yesod.Html.Components.NProgress.html#parent"><span class="hs-identifier">parent</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">SelectorGroup</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJSON</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-type">NProgressConfig</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-38"></a><span>    </span><a name="local-8214565720323785820"><span class="hs-identifier">toJSON</span></a><span> </span><span class="hs-special">(</span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-var">NProgressConfig</span></a><span> </span><a name="local-6989586621679086604"><a href="#local-6989586621679086604"><span class="hs-identifier">mn</span></a></a><span> </span><a name="local-6989586621679086605"><a href="#local-6989586621679086605"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679086606"><a href="#local-6989586621679086606"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679086607"><a href="#local-6989586621679086607"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679086608"><a href="#local-6989586621679086608"><span class="hs-identifier">ts</span></a></a><span> </span><a name="local-6989586621679086609"><a href="#local-6989586621679086609"><span class="hs-identifier">ss</span></a></a><span> </span><a name="local-6989586621679086610"><a href="#local-6989586621679086610"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">object</span><span> </span><span class="hs-special">[</span><span>
</span><a name="line-39"></a><span>        </span><span class="hs-string">&quot;minimum&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086604"><span class="hs-identifier hs-var">mn</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>        </span><span class="hs-string">&quot;easing&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086605"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>        </span><span class="hs-string">&quot;speed&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086606"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>        </span><span class="hs-string">&quot;trickle&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086607"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>        </span><span class="hs-string">&quot;trickleSpeed&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086608"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>        </span><span class="hs-string">&quot;showSpinner&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086609"><span class="hs-identifier hs-var">ss</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>        </span><span class="hs-string">&quot;parent&quot;</span><span> </span><span class="hs-operator hs-var">.=</span><span> </span><a href="#local-6989586621679086610"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-46"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">ToJavascript</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-type">NProgressConfig</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-49"></a><span>    </span><a name="local-8214565720323809827"><span class="hs-identifier">toJavascript</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toJavascript</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toJSON</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Default</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-type">NProgressConfig</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-52"></a><span>    </span><a name="local-8214565720323799798"><span class="hs-identifier">def</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-var">NProgressConfig</span></a><span> </span><span class="hs-number">0.08</span><span> </span><span class="hs-identifier hs-var">Ease</span><span> </span><span class="hs-number">200</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-number">200</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="">[csssel|body|]</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-identifier">nProgressWidget</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadWidget</span><span> </span><a href="#local-6989586621679087580"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679087580"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><a name="nProgressWidget"><a href="Yesod.Html.Components.NProgress.html#nProgressWidget"><span class="hs-identifier">nProgressWidget</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Html.Components.NProgress.html#cssFileInclude"><span class="hs-identifier hs-var">cssFileInclude</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Yesod.Html.Components.NProgress.html#jsFileInclude"><span class="hs-identifier hs-var">jsFileInclude</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">toWidgetBody</span><span> </span><a href="Yesod.Html.Components.NProgress.html#startDoneProgress"><span class="hs-identifier hs-var">startDoneProgress</span></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-identifier">nProgressWidgetConfig</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MonadWidget</span><span> </span><a href="#local-6989586621679087579"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Yesod.Html.Components.NProgress.html#NProgressConfig"><span class="hs-identifier hs-type">NProgressConfig</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679087579"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><a name="nProgressWidgetConfig"><a href="Yesod.Html.Components.NProgress.html#nProgressWidgetConfig"><span class="hs-identifier">nProgressWidgetConfig</span></a></a><span> </span><a name="local-6989586621679088188"><a href="#local-6989586621679088188"><span class="hs-identifier">npc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Yesod.Html.Components.NProgress.html#cssFileInclude"><span class="hs-identifier hs-var">cssFileInclude</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="Yesod.Html.Components.NProgress.html#jsFileInclude"><span class="hs-identifier hs-var">jsFileInclude</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">toWidgetBody</span><span> </span><span class="hs-special">(</span><a href="Yesod.Html.Components.NProgress.html#configureProgress"><span class="hs-identifier hs-var">configureProgress</span></a><span> </span><a href="#local-6989586621679088188"><span class="hs-identifier hs-var">npc</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Yesod.Html.Components.NProgress.html#startDoneProgress"><span class="hs-identifier hs-var">startDoneProgress</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a></pre></body></html>